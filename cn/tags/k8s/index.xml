<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>k8s on</title><link>https://gohalo.github.io/cn/tags/k8s/</link><description>Recent content in k8s on</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Tue, 28 Mar 2023 21:33:42 +0800</lastBuildDate><atom:link href="https://gohalo.github.io/cn/tags/k8s/index.xml" rel="self" type="application/rss+xml"/><item><title>K8S Controller 使用详解</title><link>https://gohalo.github.io/cn/blog/kubernets-crd-controller-details/</link><pubDate>Tue, 28 Mar 2023 21:33:42 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-crd-controller-details/</guid><description>简介 # 在构建自定义的 Operator 时会涉及到如下几种组件：
client-go 底层用于与 K8S API 进行交互，支持资源的 CRUD 操作，包含了 ClientSet、DynamicClient、RESTClient 三种。 controller-runtime 封装了控制器的处理框架，底层会调用 client-go 库。 kubebuilder 可以很方便渲染出 Controller 整个框架，该框架使用的就是 controller-runtime 模块。 operator-sdk 同样基于 controller-runtime 实现，而且同时使用了 kubebuilder 来构建 Go 项目。 简单来说，当前 Controller 的编写包含了 OperatorSDK、Kubebuilder、ClientGo 三种方式，前两者提供了更加实用的封装，而 ClientGo 相对来说要简单很多，这里简单介绍 Kubebuilder 的使用方式。
Kubebuilder # Kubebuilder 由 K8S Special Interest Group, SIG API Machinery 拥有和维护，用于帮助开发者创建 CRD 并生成 Controller 脚手架，包含了如下的组件：
Client 封装了对资源的操作，修改会直接访问 APIServer ，而查询则会访问本地 Cache 信息。 Cache 负责生成 SharedInformer，会监听 GVK 下的 GVR 变化，然后触发 Controller 的 Reconcile 逻辑。 Manager 管理协调多个 Controller，提供共有依赖以及基础服务(例如保活)，负责初始化 Controller、Cache、Client 的工作。 Finzlizers 用于处理资源的预删除逻辑，保障资源被删除后能够从 Cache 中读取到，清理相关的其它资源。 Builder 构造器，提供了一系列配置接口，可以通过链式条用进行组装，最终为 Reconciler 生成相应的 Controller 对象。 示例 # 可以直接从 GitHub Release 上下载对应的二进制文件。</description></item><item><title>CRD 使用详解</title><link>https://gohalo.github.io/cn/blog/kubernets-crd-sample/</link><pubDate>Mon, 12 Dec 2022 19:17:52 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-crd-sample/</guid><description>&lt;p>在 K8S 1.7 开始支持 Custom Resource Define, CRD 自定义资源，这样可以动态注册到集群中，就与其它资源类似可以通过 kubectl 来管理该资源了。注意，此时的 CRD 仅仅是资源的定义而已，需要一个 Controller 去监听 CRD 的各种事件来添加自定义的业务逻辑。&lt;/p></description></item><item><title>K8S 本地集群 Kind 使用介绍</title><link>https://gohalo.github.io/cn/blog/kubernets-minimal-kind-cluster/</link><pubDate>Sat, 12 Nov 2022 20:10:42 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-minimal-kind-cluster/</guid><description>&lt;p>kind 是 Kubernetes in Docker 的简写，是一个使用 Docker 容器作为 Nodes，在本地创建和运行 Kubernetes 群集的工具，适用于在本机创建 Kubernetes 群集环境进行开发和测试，而且支持离线部署。&lt;/p></description></item><item><title>K8S 包管理工具 Helm 介绍</title><link>https://gohalo.github.io/cn/blog/kubernets-helm-introduce/</link><pubDate>Mon, 21 Mar 2022 19:50:47 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-helm-introduce/</guid><description>&lt;p>Helm 是 K8S 中的包管理器，可以非常方便的完成应用的安装、卸载、升级等，Chart 是 Helm 的打包格式，其内部包含了一组相关的 K8S 资源。&lt;/p></description></item><item><title>K8S 配置上下文介绍</title><link>https://gohalo.github.io/cn/blog/kubernets-config-context/</link><pubDate>Wed, 22 Dec 2021 19:40:02 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-config-context/</guid><description>&lt;p>通常在开发过程中需要维护多个集群，例如研发、测试、生产等，为了方便管理可以通过 kubeconfig 维护集群、用户、命名空间、身份认证相关的信息，用来快速切换访问的集群。&lt;/p></description></item><item><title>K8S 存储</title><link>https://gohalo.github.io/cn/blog/kubernets-storage/</link><pubDate>Fri, 22 Oct 2021 19:43:02 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-storage/</guid><description/></item><item><title>通过 go-client 访问 K8S 集群</title><link>https://gohalo.github.io/cn/blog/kubernets-source-code-go-client/</link><pubDate>Tue, 12 Oct 2021 23:11:42 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-source-code-go-client/</guid><description>&lt;p>&lt;code>client-go&lt;/code> 是用 GoLang 编写的官方编程式交互客户端库，提供对 Kubernetes API Server 服务的交互访问，也是 Kubernetes 的核心处理框架，其源码中已经集成了 &lt;code>client-go&lt;/code> 的源码，无需单独下载。&lt;/p></description></item><item><title>K8S ConfigMap 使用介绍</title><link>https://gohalo.github.io/cn/blog/kubernets-components-configmap/</link><pubDate>Fri, 10 Sep 2021 20:18:02 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-components-configmap/</guid><description>&lt;p>在 K8S 中可以通过 configmap 保存应用的配置，这样就将配置和运行代码分开了。&lt;/p></description></item><item><title>K8S 简单安装部署服务</title><link>https://gohalo.github.io/cn/blog/kubernets-simple-install/</link><pubDate>Tue, 04 May 2021 21:15:32 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-simple-install/</guid><description>&lt;p>现在很多的 K8S 部署是通过容器安装的，这里介绍如何在物理机上独立部署，这也是最简单的方式。&lt;/p></description></item><item><title>Kubernets 网络示例</title><link>https://gohalo.github.io/cn/blog/kubernets-examples-nginx/</link><pubDate>Fri, 19 Mar 2021 21:19:12 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-examples-nginx/</guid><description>&lt;p>这里以 Nginx 为例，介绍几种常见的网络模型。&lt;/p></description></item><item><title>K8S Ingress 详细介绍</title><link>https://gohalo.github.io/cn/blog/kubernets-components-ingress/</link><pubDate>Wed, 10 Mar 2021 23:19:41 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-components-ingress/</guid><description/></item><item><title>K8S 常用命令</title><link>https://gohalo.github.io/cn/blog/kubernets-commands-usage/</link><pubDate>Fri, 08 Jan 2021 19:43:02 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-commands-usage/</guid><description>&lt;p>整理下 K8S 的常用命令，以供参考。&lt;/p></description></item><item><title>K8S 网络简介</title><link>https://gohalo.github.io/cn/blog/kubernets-network-introduce/</link><pubDate>Mon, 21 Dec 2020 20:30:52 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-network-introduce/</guid><description>简介 # K8S 中的网络以及 IP 地址都分了三层，分别为：
Node Network 各个 Node 之间的通讯方式，可以是物理网络或者虚拟网络； Pod Network 各个 Pod 之间通讯，Pod 可以在 Node 内部，也可以是跨 Node ； Service Network 也就是 Pod 对外部暴露的接口，创建 Service 时会新建一个 IP 。 与之对应的 IP 地址包括了：
Node IP 每个 Node 之间通讯时，分配的 IP 地址； Pod IP 每个 Pod 会分配一个 IP 地址，一般由 Pause 容器创建，一个 Node 中可以包含多个 Pod ； Cluster IP 对应了 Service 内部 IP ，作为服务的入口。 K8S 支持 Flannel、Calico、Weave Network 等多种 CNI 网络驱动。
Docker 网络 # 在 Docker 的后台服务启动之后，会创建一个 docker0 的网关，容器默认会分配在一个以 docker0 为默认网关的虚拟子网中。</description></item><item><title>Kubernetes 基本介绍</title><link>https://gohalo.github.io/cn/blog/kubernets-basic-introduce/</link><pubDate>Thu, 10 Dec 2020 21:50:32 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-basic-introduce/</guid><description/></item><item><title>K8S 制作离线镜像</title><link>https://gohalo.github.io/cn/blog/kubernets-create-offline-images/</link><pubDate>Mon, 06 Jul 2020 19:18:25 +0800</pubDate><guid>https://gohalo.github.io/cn/blog/kubernets-create-offline-images/</guid><description>&lt;p>大部分的镜像制作都是通过 Dockerfile 来实现的，基本都是基于基础镜像制作，这里介绍使用 &lt;code>buildah&lt;/code> 来构建基础镜像，可以以此理解其基本原理。&lt;/p></description></item></channel></rss>