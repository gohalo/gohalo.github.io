<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Python 常用模块 | GoHalo</title><link rel=apple-touch-icon sizes=180x180 href=https://gohalo.github.io/favicon/apple-touch-icon.png><link rel=icon href=https://gohalo.github.io/favicon/favicon.ico sizes=any><link rel=icon type=image/png sizes=32x32 href=https://gohalo.github.io/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://gohalo.github.io/favicon/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://gohalo.github.io/favicon/site.webmanifest><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=google-site-verification content="p7jJ5d3kF9yxRhpIo5GgHXAZ1ATKVyZhV2kf6mEGOv0"><meta name=description content><link rel=stylesheet href=https://gohalo.github.io/font-awesome/css/font-awesome.min.css><link rel=stylesheet href=/css/syntax.min.c70103877c799b924f50023b6b01eca010d7e2808885a74f9ea662cc47379ae1.css integrity="sha256-xwEDh3x5m5JPUAI7awHsoBDX4oCIhadPnqZizEc3muE=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.c4814ac9dc5fab259f313a787ded4f8e.css integrity="md5-xIFKydxfqyWfMTp4fe1Pjg==" crossorigin=anonymous><style type=text/css>.main p{text-indent:2em}.main li p{text-indent:0}</style><noscript><style>img.lazyload{display:none}</style></noscript></head><body><div class=sticky-top><div class=header-bar></div><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/cn aria-label=GoHalo>GoHalo</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>项目</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a class=dropdown-item href=/cn/project/bastion/>Bastion</a></li><li><a class="dropdown-item disabled" href=/cn/project/bootserver/>BootServer</a></li></ul></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/>博客</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/archives/>归档</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/tags/>标签</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/slide/>幻灯片</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/docs/>文档</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn dropdown-toggle" id=header-languages data-bs-toggle=dropdown aria-expanded=false data-bs-display=static>
中文</button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=header-languages><li><a class=dropdown-item rel=alternate href=https://gohalo.github.io/en hreflang=en lang=en>English</a></li></ul></div><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=/cn/about><i class="fa fa-user" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/gohalo title=GitHub><i class="fa fa-github-alt" aria-hidden=true></i></a></li><li class=nav-item><button id=mode class="btn nav-link social-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><i class="fa fa-star" aria-hidden=true></i></span>
<span class=toggle-light><i class="fa fa-cog" aria-hidden=true></i></span></button></li></ul></div></div></nav></div><div class="main container-xxl" role=document><div class="blog row"><div class="col-md-12 col-xl-9 mt-4"><div class=header><h1>Python 常用模块</h1><div class="meta mb-3"><i class="fa fa-calendar" aria-hidden=true></i>
<span class=mx-2>2020-01-03</span>
<i class="fa fa-tags" aria-hidden=true></i>
<a class=text-body href=https://gohalo.github.io/cn/tags/language/ role=button>language</a>
<a class=text-body href=https://gohalo.github.io/cn/tags/python/ role=button>python</a></div></div><hr><div class=content><a class=anchor id=functools></a><h1>functools <a href=#functools aria-hidden=true>#</a></h1><p>functools 是 python2.5 引人的，可以参考官方文档 <a href=https://docs.python.org/2/library/functools.html>functools — Higher-order functions and operations on callable objects</a></p><a class=anchor id=reduce></a><h2>reduce <a href=#reduce aria-hidden=true>#</a></h2><p>这个与 Python 内置的 reduce 相同，每次迭代，将上一次的迭代结果与下一个元素一同执行一个二元的 func 函数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>functools</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>functools</span><span class=o>.</span><span class=n>reduce</span><span class=p>((</span><span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>:</span><span class=n>x</span><span class=o>+</span><span class=n>y</span><span class=p>),</span> <span class=n>a</span><span class=p>)</span>  <span class=c1># 1+2+3+4+5=15</span>
</span></span><span class=line><span class=cl><span class=n>reduce</span><span class=p>((</span><span class=k>lambda</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>:</span><span class=n>x</span><span class=o>+</span><span class=n>y</span><span class=p>),</span> <span class=n>a</span><span class=p>)</span>            <span class=c1># 1+2+3+4+5=15</span>
</span></span></code></pre></div><a class=anchor id=partial></a><h2>partial <a href=#partial aria-hidden=true>#</a></h2><p>对于一个带 <code>n</code> 个参数函数，partial 会将第一个参数设置为固定参数，并返回一个带 <code>n-1</code> 个参数函数对象。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>operator</span> <span class=kn>import</span> <span class=n>add</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>partial</span>
</span></span><span class=line><span class=cl><span class=n>add3</span> <span class=o>=</span> <span class=n>partial</span><span class=p>(</span><span class=n>add</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>add3</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span>            <span class=c1># 3+7=10</span>
</span></span></code></pre></div><a class=anchor id=collections-模块></a><h1>collections 模块 <a href=#collections-%e6%a8%a1%e5%9d%97 aria-hidden=true>#</a></h1><p>该三方模块提供了对内置类型的扩展，是 Python 内建的一个集合模块，提供了许多有用的集合类，包括了多个对象，详细可以查看官方文档 <a href=https://docs.python.org/2/library/collections.html>collections High-performance container datatypes</a> 。</p><a class=anchor id=defaultdict></a><h2>defaultdict <a href=#defaultdict aria-hidden=true>#</a></h2><p>在使用 Python 内置的 dict 时，如果引用的 Key 不存在，就会抛出 KeyError，如果希望 key 不存在时，返回一个默认值，就可以用 <code>defaultdict</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;&gt;&gt; from collections import defaultdict
</span></span><span class=line><span class=cl>&gt;&gt;&gt; dd = defaultdict(lambda: &#39;N/A&#39;)
</span></span><span class=line><span class=cl>&gt;&gt;&gt; dd[&#39;key1&#39;] = &#39;abc&#39;
</span></span><span class=line><span class=cl>&gt;&gt;&gt; dd[&#39;key1&#39;]                       ← key1存在
</span></span><span class=line><span class=cl>&#39;abc&#39;
</span></span><span class=line><span class=cl>&gt;&gt;&gt; dd[&#39;key2&#39;]                       ← key2不存在，返回默认值
</span></span><span class=line><span class=cl>&#39;N/A&#39;
</span></span></code></pre></div><p>注意默认值是调用函数返回的，而函数在创建 <code>defaultdict</code> 对象时传入，除了在 Key 不存在时返回默认值外，该对象的其他行为跟 dict 是完全一样的。</p><a class=anchor id=ordereddict></a><h2>OrderedDict <a href=#ordereddict aria-hidden=true>#</a></h2><p>使用 Python 内置的字典对象时，Key 是无序的，这样当对 dict 做迭代时，无法确定 Key 的顺序，如果要保持 Key 的顺序，可以用 OrderedDict 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;&gt;&gt; from collections import OrderedDict
</span></span><span class=line><span class=cl>&gt;&gt;&gt; d = dict([(&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;c&#39;, 3)])
</span></span><span class=line><span class=cl>&gt;&gt;&gt; d                                ← dict的Key是无序的
</span></span><span class=line><span class=cl>{&#39;a&#39;: 1, &#39;c&#39;: 3, &#39;b&#39;: 2}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt;&gt;&gt; od = OrderedDict([(&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;c&#39;, 3)])
</span></span><span class=line><span class=cl>&gt;&gt;&gt; od                               ← OrderedDict的Key是有序的
</span></span><span class=line><span class=cl>OrderedDict([(&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;c&#39;, 3)])
</span></span></code></pre></div><p>OrderedDict 的 Key 会 <strong>按照插入的顺序排列</strong> ，不是 Key 本身排序：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;&gt;&gt; od = OrderedDict()
</span></span><span class=line><span class=cl>&gt;&gt;&gt; od[&#39;z&#39;] = 1
</span></span><span class=line><span class=cl>&gt;&gt;&gt; od[&#39;y&#39;] = 2
</span></span><span class=line><span class=cl>&gt;&gt;&gt; od[&#39;x&#39;] = 3
</span></span><span class=line><span class=cl>&gt;&gt;&gt; od.keys()                        ← 按照插入的Key的顺序返回
</span></span><span class=line><span class=cl>[&#39;z&#39;, &#39;y&#39;, &#39;x&#39;]
</span></span></code></pre></div><p>另外，通过 OrderedDict 可以实现一个 FIFO (先进先出) 的 dict，当容量超出限制时，先删除最早添加的 Key：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>OrderedDict</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>LastUpdatedOrderedDict</span><span class=p>(</span><span class=n>OrderedDict</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>capacity</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>(</span><span class=n>LastUpdatedOrderedDict</span><span class=p>,</span> <span class=bp>self</span><span class=p>)</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_capacity</span> <span class=o>=</span> <span class=n>capacity</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__setitem__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>containsKey</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=bp>self</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-</span> <span class=n>containsKey</span> <span class=o>&gt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_capacity</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>last</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>popitem</span><span class=p>(</span><span class=n>last</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span> <span class=s1>&#39;remove:&#39;</span><span class=p>,</span> <span class=n>last</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>containsKey</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>del</span> <span class=bp>self</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span> <span class=s1>&#39;set:&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span> <span class=s1>&#39;add:&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>OrderedDict</span><span class=o>.</span><span class=fm>__setitem__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span></span></code></pre></div><a class=anchor id=namedtuple></a><h2>namedtuple <a href=#namedtuple aria-hidden=true>#</a></h2><p>在 Python 中，tuple 可以 <strong>表示不变集合</strong> ，例如，一个点的二维坐标就可以表示成 (1, 2)。但是，看到 (1, 2) 后，很难看出这个 tuple 是用来表示一个坐标的，不过定义一个类又小题大做了，这时就可以使用该对象了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;&gt;&gt; from collections import namedtuple
</span></span><span class=line><span class=cl>&gt;&gt;&gt; P = namedtuple(&#39;Point&#39;, [&#39;x&#39;, &#39;y&#39;])
</span></span><span class=line><span class=cl>&gt;&gt;&gt; p = P(1, 2)
</span></span><span class=line><span class=cl>&gt;&gt;&gt; print p
</span></span><span class=line><span class=cl>Point(x=1, y=2)
</span></span><span class=line><span class=cl>&gt;&gt;&gt; p.x
</span></span><span class=line><span class=cl>1
</span></span><span class=line><span class=cl>&gt;&gt;&gt; p.y
</span></span><span class=line><span class=cl>2
</span></span><span class=line><span class=cl>&gt;&gt;&gt; p.x = 3                          ← 只读变量，设置会报错
</span></span><span class=line><span class=cl>Traceback (most recent call last):
</span></span><span class=line><span class=cl>  File &#34;&lt;stdin&gt;&#34;, line 1, in &lt;module&gt;
</span></span><span class=line><span class=cl>AttributeError: can&#39;t set attribute
</span></span></code></pre></div><p>namedtuple 是一个函数，它用来创建一个自定义的 tuple 对象，并且规定了 tuple 元素的个数，并可以用属性而不是索引来引用 tuple 的某个元素。这样一来，我们用 namedtuple 可以很方便地定义一种数据类型，它具备 tuple 的不变性，又可以根据属性来引用，使用十分方便。</p><p>对于如上的示例，可以通过如下方式验证创建的 Point 对象是 tuple 的一种子类：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;&gt;&gt; isinstance(p, Point)
</span></span><span class=line><span class=cl>True
</span></span><span class=line><span class=cl>&gt;&gt;&gt; isinstance(p, tuple)
</span></span><span class=line><span class=cl>True
</span></span></code></pre></div><a class=anchor id=deque></a><h2>deque <a href=#deque aria-hidden=true>#</a></h2><p>使用 list 存储数据时，按索引访问元素很快，但是插入和删除元素就很慢了，因为 list 是线性存储，数据量大的时候，插入和删除效率很低。deque 是为了高效实现插入和删除操作的双向列表，适合用于队列和栈：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;&gt;&gt; from collections import deque
</span></span><span class=line><span class=cl>&gt;&gt;&gt; q = deque([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;])
</span></span><span class=line><span class=cl>&gt;&gt;&gt; q.append(&#39;x&#39;)
</span></span><span class=line><span class=cl>&gt;&gt;&gt; q.appendleft(&#39;y&#39;)
</span></span><span class=line><span class=cl>&gt;&gt;&gt; q
</span></span><span class=line><span class=cl>deque([&#39;y&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;x&#39;])
</span></span></code></pre></div><p>deque 除了实现 list 的 <code>append()</code> 和 <code>pop()</code> 外，还支持 <code>appendleft()</code> 和 <code>popleft()</code>，这样就可以非常高效地往头部添加或删除元素。</p><a class=anchor id=json-模块></a><h1>JSON 模块 <a href=#json-%e6%a8%a1%e5%9d%97 aria-hidden=true>#</a></h1><p>JSON (JavaScript Object Notation) 是一种轻量级的数据交换格式，采用完全独立于语言的文本格式，是 &ldquo;名称/值&rdquo; 的集合，详细可以参考 <a href=http://json.org/>官方文档</a> 。Python2.6 开始加入了 JSON 标准模块，序列化与反序列化的过程分别是 encoding 和 decoding 。</p><p>对于简单数据类型，如 string、unicode、int、float、list、tuple、dict，可以直接处理，详细的也可以参考 <a href=http://docs.python.org/library/json.html>Python 操作 json 的标准 api 库</a> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>({</span><span class=s1>&#39;4&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=s1>&#39;6&#39;</span><span class=p>:</span> <span class=mi>7</span><span class=p>},</span> <span class=n>sort_keys</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=s1>&#39;[&#34;foo&#34;, {&#34;bar&#34;:[&#34;baz&#34;, null, 1.0, 2]}]&#39;</span><span class=p>)</span>
</span></span></code></pre></div></div></div><div class="sidebar col-xl-3 mt-2"><div id=toc class=position-fixed><nav id=TableOfContents><ul><li><a href=#functools>functools</a><ul><li><a href=#reduce>reduce</a></li><li><a href=#partial>partial</a></li></ul></li><li><a href=#collections-模块>collections 模块</a><ul><li><a href=#defaultdict>defaultdict</a></li><li><a href=#ordereddict>OrderedDict</a></li><li><a href=#namedtuple>namedtuple</a></li><li><a href=#deque>deque</a></li></ul></li><li><a href=#json-模块>JSON 模块</a></li></ul></nav></div></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class=text-center>Built by GoHalo, generated with <a class=text-muted href=https://gohugo.io>Hugo</a>, and hosted on GitHub Pages</div></div><div class=row><div class=text-center>Copyright © 2013-2025 GoHalo. All Rights Reserved.</div></div></div></footer><script src=https://gohalo.github.io/bootstrap/js/bootstrap.bundle.min.js></script>
<script src=/main.b9cbcb174709877512d64e24f297f66a40c8d91c9a81128cb04bdd7b10247df8.js integrity="sha256-ucvLF0cJh3US1k4k8pf2akDI2RyagRKMsEvdexAkffg=" crossorigin=anonymous></script>
<a href=# class="btn btn-light btn-lg backtop" title=返回顶部><i class="fa fa-angle-double-up" aria-hidden=true></i></a></body></html>