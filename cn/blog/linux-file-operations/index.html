<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Linux 文件操作 | GoHalo</title><link rel=apple-touch-icon sizes=180x180 href=https://gohalo.github.io/favicon/apple-touch-icon.png><link rel=icon href=https://gohalo.github.io/favicon/favicon.ico sizes=any><link rel=icon type=image/png sizes=32x32 href=https://gohalo.github.io/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://gohalo.github.io/favicon/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://gohalo.github.io/favicon/site.webmanifest><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=google-site-verification content="p7jJ5d3kF9yxRhpIo5GgHXAZ1ATKVyZhV2kf6mEGOv0"><meta name=description content="Linux 的设计理念是：一切都是文件！在此简单介绍下 Linux 中常见的文件操作。
"><link rel=stylesheet href=https://gohalo.github.io/font-awesome/css/font-awesome.min.css><link rel=stylesheet href=/css/syntax.min.c70103877c799b924f50023b6b01eca010d7e2808885a74f9ea662cc47379ae1.css integrity="sha256-xwEDh3x5m5JPUAI7awHsoBDX4oCIhadPnqZizEc3muE=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.c4814ac9dc5fab259f313a787ded4f8e.css integrity="md5-xIFKydxfqyWfMTp4fe1Pjg==" crossorigin=anonymous><style type=text/css>.main p{text-indent:2em}.main li p{text-indent:0}</style><noscript><style>img.lazyload{display:none}</style></noscript></head><body><div class=sticky-top><div class=header-bar></div><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/cn aria-label=GoHalo>GoHalo</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>项目</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a class=dropdown-item href=/cn/project/bastion/>Bastion</a></li><li><a class="dropdown-item disabled" href=/cn/project/bootserver/>BootServer</a></li></ul></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/>博客</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/archives/>归档</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/tags/>标签</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/slide/>幻灯片</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/docs/>文档</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn dropdown-toggle" id=header-languages data-bs-toggle=dropdown aria-expanded=false data-bs-display=static>
中文</button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=header-languages><li><a class=dropdown-item rel=alternate href=https://gohalo.github.io/en hreflang=en lang=en>English</a></li></ul></div><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=/cn/about><i class="fa fa-user" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/gohalo title=GitHub><i class="fa fa-github-alt" aria-hidden=true></i></a></li><li class=nav-item><button id=mode class="btn nav-link social-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><i class="fa fa-star" aria-hidden=true></i></span>
<span class=toggle-light><i class="fa fa-cog" aria-hidden=true></i></span></button></li></ul></div></div></nav></div><div class="main container-xxl" role=document><div class="blog row"><div class="col-md-12 col-xl-9 mt-4"><div class=header><h1>Linux 文件操作</h1><div class="meta mb-3"><i class="fa fa-calendar" aria-hidden=true></i>
<span class=mx-2>2014-03-10</span>
<i class="fa fa-tags" aria-hidden=true></i>
<a class=text-body href=https://gohalo.github.io/cn/tags/linux/ role=button>linux</a></div></div><hr><div class=content><p>Linux 的设计理念是：一切都是文件！在此简单介绍下 Linux 中常见的文件操作。</p><a class=anchor id=文件></a><h1>文件 <a href=#%e6%96%87%e4%bb%b6 aria-hidden=true>#</a></h1><p>通过 <code>ls -l test</code> 命令可以查看文件 test 的属性，通常可以得到如下的内容：</p><p><img alt="Linux file properties" src=images/filesystem-file-property-1.jpg class="mx-auto d-block"></p><p>第二栏表示的是有多少文件连接到 inode ，如果是一个文件，此时这一字段表示这个文件所具有的硬链接数，如果是一个目录，则此字段表示该目录所含子目录的个数，包括 <code>.</code> 、<code>..</code> 以及隐藏目录。</p><p>每个文件都会将他的权限与属性记录到文件系统的 inode 中，不过，我们使用的目录树却是使用文件名来记录，因此每个档名就会连结到一个 i-node 这个属性记录的，就是有多少不同的档名连结到相同的一个 i-node 号码去就是了。</p><a class=anchor id=文件类型></a><h2>文件类型 <a href=#%e6%96%87%e4%bb%b6%e7%b1%bb%e5%9e%8b aria-hidden=true>#</a></h2><p>在 Linux 中，总共有四种文件类型，包括普通文件、目录文件、连接文件和特殊文件，那么可以通过 file 命令来查看。</p><ul><li>普通文件(regular file)：包括纯文本文件 (ASCII) ，二进制文件 (binary) ，资料格式文件 (data) ， data 主要是指以特定格式存储的文件，如使用 Linux 登录时会将记录存放在 <code>/var/log/wtmp</code> 中，这就是一个 data file，可以通过 last 来查看，但是不能用 cat 。<code>ls -l</code> 可以看到 <code>-</code> 。</li><li>目录文件(directory)：包括文件名、子目录名及其指针。<code>ls -l</code> 可以看到 <code>d</code> 。</li><li>连接文件(link)：是指向同一索引节点的那些目录条目，通常为符号链接。<code>ls -l</code> 可以看到 <code>l</code> 。</li><li>设备相关文件(device)：这些文件通常放在 <code>/dev</code> 中，又可以分为块设备文件 (如硬盘) 和字符文件 (如键盘、鼠标)。<code>ls -l</code> 可以分别看到 <code>b/c</code> 。</li><li>网络接口文件(sockets)：用于网络上的数据传输，常在 <code>/var/run</code> 中。<code>ls -l</code> 可以看到 <code>s</code> 。</li><li>管道文件(FIFO, pipe)：主要用于数据的读写，如命令管道。<code>ls -l</code> 可以看到 <code>p</code> 。</li></ul><a class=anchor id=文件权限></a><h2>文件权限 <a href=#%e6%96%87%e4%bb%b6%e6%9d%83%e9%99%90 aria-hidden=true>#</a></h2><p><img alt="Linux file properties" src=images/filesystem-file-property-2.png class="mx-auto d-block"></p><p>其中第一位表示文件的类型；后九位中，每三位为一组，<code>r-read/4</code>、<code>w-write/2</code>、<code>x-excute/1</code>，分别表示 拥有者、同组用户、其他人的权限。上图表示该文件为目录，拥有者有读、写、执行的权利，而用户组其他成员和其他人没有写的权利。</p><p>只有当文件所在上一级目录有 w 的权限时，才可以新建或者删除文件，对于已经存在的文件可以进行修改。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ chown -R user:group file/dir             # 修改用户和用户组，-R 表示递归
</span></span><span class=line><span class=cl>$ chmod -R 740 file/dir                    # 修改文件或目录的权限，-R 表示递归
</span></span><span class=line><span class=cl>$ chmod u/g/o/a +/-/= r/w/x file/dir       # 分别表示user/group/others/all
</span></span></code></pre></div><p>文件默认属性可通过 <code>umask</code> 设置，<code>umask</code> 就是指 &ldquo;Linux文件的默认属性需要减掉的权限&rdquo;。</p><p>对于 Linux 来说，普通文件的最大默认属性是 666，目录的最大属性是 777；如果不想要用户在新建立文件时使用默认的属性，那么就要设置 umask 值。</p><p>在 CentOS 中，系统默认的 umask 值是 0002，那么用户在新建立普通文件时，普通文件的属性就是 666-0002=664，新建目录时，目录的属性就是 777-0002=755。</p><p>可以通过如下的命令进行查看设置。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ umask                  # 查看
</span></span><span class=line><span class=cl>$ umaks 0002             # 设置
</span></span></code></pre></div><a class=anchor id=文件的特殊权限></a><h2>文件的特殊权限 <a href=#%e6%96%87%e4%bb%b6%e7%9a%84%e7%89%b9%e6%ae%8a%e6%9d%83%e9%99%90 aria-hidden=true>#</a></h2><p>除了上述的读写执行权限之外，Linux 还定义了其他的权限。</p><a class=anchor id=suid></a><h4>SUID <a href=#suid aria-hidden=true>#</a></h4><p>当一个设置了 SUID 位的可执行文件被执行时，无论那个用户来执行该文件，该文件将以所有者的身份运行，都有文件所有者的特权。如果所有者是 root 的话，那么执行人就有超级用户的特权了。</p><p>例如 <code>/etc/passwd</code> 的权限为 <code>-rw-r--r-- root root</code> ，也就是说只有 root 才能修改，但是我们可以通过 <code>/usr/bin/passwd</code> 来修改密码。通过 <code>ls -l /usr/bin/passwd</code> 可以看到其属性为 <code>-rwsr-xr-x root root</code> 因此在执行时获得了 root 的权限。</p><p><strong>NOTE</strong>: 该属性仅可用在可执行文件，不用于脚本文件和目录(可以进行设置，但是应该无效)。因为脚本时一系列命令的集合体，不同的命令可能会对应于不同的属性。</p><a class=anchor id=sgid></a><h4>SGID <a href=#sgid aria-hidden=true>#</a></h4><p>当一个设置了 SGID 位的可执行文件运行时，该文件将具有所属组的特权， 任意存取整个组所能使用的系统资源。</p><p>若目录设置了 SGID ，则所有被复制到这个目录下的文件，其属组都会被重设为和这个目录一样，除非在复制文件时加上 <code>-p</code> (preserve，保留文件属性) 参数，才能保留原来所属的群组设置。</p><p><strong>NOTE</strong>: 一般来说， SGID 多用在特定的多人团队的项目开发上，在系统中用得较少。</p><a class=anchor id=粘着位sticky-bit></a><h4>粘着位(Sticky Bit) <a href=#%e7%b2%98%e7%9d%80%e4%bd%8dsticky-bit aria-hidden=true>#</a></h4><p>只针对目录有效，对文件没有效果。如果用户在该目录下面具有 w 和 x 权限，当用户在该目录下建立文件或者目录时，只有文件拥有者和 root 用户才有权力删除(注意目录的所有者也可以删除文件的)。</p><a class=anchor id=设置></a><h4>设置 <a href=#%e8%ae%be%e7%bd%ae aria-hidden=true>#</a></h4><p>可以通过如下的命令进行设置。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ chmod u+s(SUID) g+s(SGID) o+t(STICKY)
</span></span><span class=line><span class=cl>$ chmod 4755
</span></span></code></pre></div><p>一个文件的属性通常有 4 个八进制表示，ls 只显示了 3 个，而对于 <code>xxx-SUID,SGID,STICKY(4,2,1)</code>，与 <code>rwx</code> 相似，也采用一个数字进行表示。</p><p>设置后，可以用 <code>ls -l</code> 来查看，如果本来在该位上有 x (均显示在x位上)，则这些特殊标志显示为小写字母 <code>(s, s, t)</code>；否则，显示为大写字母 <code>(S, S, T)</code>。</p><p>对于目录来说如果通过 lsattr 无法查看属性，可以通过 <code>ls | lsattr</code> 查看；或者直接执行 lsattr。</p><a class=anchor id=文件特殊属性></a><h2>文件特殊属性 <a href=#%e6%96%87%e4%bb%b6%e7%89%b9%e6%ae%8a%e5%b1%9e%e6%80%a7 aria-hidden=true>#</a></h2><p>文件系统中除了上述的权限配置之外，还可以通过 chattr 进行设置，使用 chattr 必须为 root 用户才可以。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>chattr [-R] [-+=] [AacDdijsSu] 文件名
</span></span></code></pre></div><ul><li>A(atime)：如果设置了A属性，则这个文件的最后访问时间atime不能被修改。</li><li>a(append only)：如果设置了a属性，则这个文件只能增加数据，不允许任何进程覆盖或截断这个文件。如果某个目录具有这个属性，那么只能在这个目录下建立和修改文件，而不能删除任何文件。注意，由于vi会创建一些swp文件，因此此时会出错，使用nano。</li><li>d(No dump)：在进行文件系统备份时，dump程序将忽略这个文件。</li><li>i(immutable)：如果设置了i属性，则不能对这个文件做任何修改，包括删除、修改内容等，如果要删除必须去掉该属性。如果某个目录具有这个属性，那么只能修改该目录下的文件，而不能建立和删除文件。这个是针对所有用户，而修改目录的w权限对root无效。</li></ul><p>其中可以通过 <code>+</code> 添加，<code>-</code> 取消，以及 <code>=</code> 设置文件属性。</p><p>其中 <code>e</code> 标示文件系统支持 <code>extents</code> 属性，一般会在 ext4 中使用，可以通过 <code>df -Th</code> <code>lsblk -f</code> 查看当前所挂载磁盘的文件系统类型。</p><blockquote><p>所谓的 extents 属性，主要是针对大文件，只需要记录文件的起始以及结束地址即可，无需记录所有的块，可以有效降低元数据的大小。</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>----- 查看某个文件的磁盘分片
</span></span><span class=line><span class=cl># filefrag -v FILENAME
</span></span></code></pre></div><a class=anchor id=文件时间属性></a><h2>文件时间属性 <a href=#%e6%96%87%e4%bb%b6%e6%97%b6%e9%97%b4%e5%b1%9e%e6%80%a7 aria-hidden=true>#</a></h2><p>在 Linux 中，没有文件创建时间的概念，只有文件的访问时间、修改时间、状态改变时间，也就是说不能知道文件的创建时间。</p><p>但如果文件创建后就没有修改过，修改时间 = 创建时间；如果文件创建后，状态就没有改变过，那么状态改变时间 = 创建时间；如果文件创建后，没有被读取过，那么访问时间 = 创建时间，这个基本不太可能。</p><ul><li>modification time(mtime，修改时间)：cp，这个时间指的是文件内容修改的时间，而不是文件属性的修改，当数据内容修改时，这个时间就会改变，用命令 ls -l 默认显示的就是这个时间。</li><li>access time(atime，访问时间)：cp, cat, more，当读取文件内容时，就会更改这个时间，例如使用 cat more vi 等命令，那么该文件的 atime 就会改变，ls stat 不会改变访问时间。注意：可能由于 Linux 缓存机制，第一次读取文件后，下次可能不会访问该文件，因此atime不会改变。</li><li>change time(ctime，属性或位置修改时间)：mv, cp, chmod, chown，当一个文件的状态改变时，这个时间就会改变，例如更改了文件的权限与属性等，它就会改变。</li></ul><a class=anchor id=其它></a><h1>其它 <a href=#%e5%85%b6%e5%ae%83 aria-hidden=true>#</a></h1><a class=anchor id=常用命令></a><h2>常用命令 <a href=#%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4 aria-hidden=true>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>----- 查看文件的类型
</span></span><span class=line><span class=cl>$ file /tmp/test
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 使用stat显示文件详细信息
</span></span><span class=line><span class=cl>$ stat file                                    # 显示文件的信息
</span></span><span class=line><span class=cl>$ stat -t file                                 # 与上相同，不过在一行显示，方便脚本处理
</span></span><span class=line><span class=cl>$ stat -f file                                 # 显示文件系统的信息
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 显示时间信息
</span></span><span class=line><span class=cl>$ ls -l --full-time file                       # 修改时间的完整格式，包含时区
</span></span><span class=line><span class=cl>$ ls -l --time=atime/ctime --full-time file    # 显示atime/ctime
</span></span></code></pre></div></div></div><div class="sidebar col-xl-3 mt-2"><div id=toc class=position-fixed><nav id=TableOfContents><ul><li><a href=#文件>文件</a><ul><li><a href=#文件类型>文件类型</a></li><li><a href=#文件权限>文件权限</a></li><li><a href=#文件的特殊权限>文件的特殊权限</a></li><li><a href=#文件特殊属性>文件特殊属性</a></li><li><a href=#文件时间属性>文件时间属性</a></li></ul></li><li><a href=#其它>其它</a><ul><li><a href=#常用命令>常用命令</a></li></ul></li></ul></nav></div></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class=text-center>Built by GoHalo, generated with <a class=text-muted href=https://gohugo.io>Hugo</a>, and hosted on GitHub Pages</div></div><div class=row><div class=text-center>Copyright © 2013-2025 GoHalo. All Rights Reserved.</div></div></div></footer><script src=https://gohalo.github.io/bootstrap/js/bootstrap.bundle.min.js></script>
<script src=/main.b9cbcb174709877512d64e24f297f66a40c8d91c9a81128cb04bdd7b10247df8.js integrity="sha256-ucvLF0cJh3US1k4k8pf2akDI2RyagRKMsEvdexAkffg=" crossorigin=anonymous></script>
<a href=# class="btn btn-light btn-lg backtop" title=返回顶部><i class="fa fa-angle-double-up" aria-hidden=true></i></a></body></html>