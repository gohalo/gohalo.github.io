<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Rust 基本语法 | GoHalo</title><link rel=stylesheet href=/static/syntax.css><link rel=stylesheet href=https://gohalo.github.io/main.c459e32cfef70be8c28586c3b8bc93e2.css integrity="md5-xFnjLP73C+jChYbDuLyT4g==" crossorigin=anonymous><style type=text/css>.content-body p{text-indent:2em}.content-body li p{text-indent:0}</style><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=google-site-verification content="p7jJ5d3kF9yxRhpIo5GgHXAZ1ATKVyZhV2kf6mEGOv0"><meta name=description content="这里简单介绍基本常用的语法。
"><link rel=canonical href=https://gohalo.github.io/cn/blog/rust-basic-syntax/><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://gohalo.github.io/#/schema/person/1","name":"","url":"https://gohalo.github.io/","sameAs":[],"image":{"@type":"ImageObject","@id":"https://gohalo.github.io/#/schema/image/1","url":"https://gohalo.github.io/\u003cnil\u003e","width":null,"height":null,"caption":""}},{"@type":"WebSite","@id":"https://gohalo.github.io/#/schema/website/1","url":"https://gohalo.github.io/","name":"GoHalo","description":"","publisher":{"@id":"https://gohalo.github.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://gohalo.github.io/cn/blog/rust-basic-syntax/","url":"https://gohalo.github.io/cn/blog/rust-basic-syntax/","name":"Rust 基本语法","description":"","isPartOf":{"@id":"https://gohalo.github.io/#/schema/website/1"},"about":{"@id":"https://gohalo.github.io/#/schema/person/1"},"datePublished":"2022-09-19T21:15:12CET","dateModified":"2022-09-19T21:15:12CET","breadcrumb":{"@id":"https://gohalo.github.io/cn/blog/rust-basic-syntax/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://gohalo.github.io/cn/blog/rust-basic-syntax/#/schema/image/2"},"inLanguage":"","potentialAction":[{"@type":"ReadAction","target":["https://gohalo.github.io/cn/blog/rust-basic-syntax/"]}]},{"@type":"BreadcrumbList","@id":"https://gohalo.github.io/cn/blog/rust-basic-syntax/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://gohalo.github.io/","url":"https://gohalo.github.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://gohalo.github.io/cn/","url":"https://gohalo.github.io/cn/","name":"Cn"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://gohalo.github.io/cn/blog/","url":"https://gohalo.github.io/cn/blog/","name":"Blog"}},{"@type":"ListItem","position":4,"item":{"@id":"https://gohalo.github.io/cn/blog/rust-basic-syntax/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://gohalo.github.io/#/schema/article/1","headline":"Rust 基本语法","description":"","isPartOf":{"@id":"https://gohalo.github.io/cn/blog/rust-basic-syntax/"},"mainEntityOfPage":{"@id":"https://gohalo.github.io/cn/blog/rust-basic-syntax/"},"datePublished":"2022-09-19T21:15:12CET","dateModified":"2022-09-19T21:15:12CET","author":{"@id":"https://gohalo.github.io/#/schema/person/2"},"publisher":{"@id":"https://gohalo.github.io/#/schema/person/1"},"image":{"@id":"https://gohalo.github.io/cn/blog/rust-basic-syntax/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://gohalo.github.io/#/schema/person/2","name":null,"sameAs":[]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://gohalo.github.io/cn/blog/rust-basic-syntax/#/schema/image/2","url":null,"contentUrl":null,"caption":"Rust 基本语法"}]}]}</script><meta name=theme-color content><link rel=icon href=https://gohalo.github.io/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://gohalo.github.io/logo.svg><link rel=apple-touch-icon sizes=180x180 href=https://gohalo.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://gohalo.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://gohalo.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://gohalo.github.io/site.webmanifest></head><body class="blog single"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/cn aria-label=GoHalo>GoHalo</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/cn/>GoHalo</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>项目
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/cn/project/bastion/>Bastion</a></li><li><a class=dropdown-item href=/cn/project/bootserver/>BootServer</a></li></ul></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/cn/blog/>博客</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/cn/blog/archives/>归档</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/cn/blog/tags/>标签</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/cn/slide/>幻灯片</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/cn/docs/>文档</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/gohalo><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><article><div class="row justify-content-center"><nav class="toc d-none d-xl-block col-xl-3"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>页面目录</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#变量>变量</a><ul><li><a href=#重定义>重定义</a></li><li><a href=#静态变量>静态变量</a></li><li><a href=#其它>其它</a></li></ul></li><li><a href=#数据类型>数据类型</a><ul><li><a href=#切片>切片</a></li><li><a href=#枚举>枚举</a></li></ul></li><li><a href=#函数>函数</a><ul><li><a href=#永不返回>永不返回</a></li></ul></li><li><a href=#控制流>控制流</a></li><li><a href=#其它-1>其它</a><ul><li><a href=#属性>属性</a></li><li><a href=#打印>打印</a></li></ul></li></ul></nav></div></div></div></div><nav id=TableOfContents><ul><li><a href=#变量>变量</a><ul><li><a href=#重定义>重定义</a></li><li><a href=#静态变量>静态变量</a></li><li><a href=#其它>其它</a></li></ul></li><li><a href=#数据类型>数据类型</a><ul><li><a href=#切片>切片</a></li><li><a href=#枚举>枚举</a></li></ul></li><li><a href=#函数>函数</a><ul><li><a href=#永不返回>永不返回</a></li></ul></li><li><a href=#控制流>控制流</a></li><li><a href=#其它-1>其它</a><ul><li><a href=#属性>属性</a></li><li><a href=#打印>打印</a></li></ul></li></ul></nav></nav><div class="blog-wrapper col-md-12 col-xl-9"><div class=blog-header><h1>Rust 基本语法</h1><div class="blog-meta mb-3"><span class=ms-2><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-calendar-check" viewBox="0 0 16 16"><path d="M10.854 7.146a.5.5.0 010 .708l-3 3a.5.5.0 01-.708.0l-1.5-1.5a.5.5.0 11.708-.708L7.5 9.793l2.646-2.647a.5.5.0 01.708.0z"/><path d="M3.5.0a.5.5.0 01.5.5V1h8V.5a.5.5.0 011 0V1h1a2 2 0 012 2v11a2 2 0 01-2 2H2a2 2 0 01-2-2V3a2 2 0 012-2h1V.5a.5.5.0 01.5-.5zM1 4v10a1 1 0 001 1h12a1 1 0 001-1V4H1z"/></svg></span><span class=mx-2>2022-09-19</span>
<span class=mx-2><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-tags" viewBox="0 0 16 16"><path d="M3 2v4.586l7 7L14.586 9l-7-7H3zM2 2a1 1 0 011-1h4.586a1 1 0 01.707.293l7 7a1 1 0 010 1.414l-4.586 4.586a1 1 0 01-1.414.0l-7-7A1 1 0 012 6.586V2z"/><path d="M5.5 5a.5.5.0 110-1 .5.5.0 010 1zm0 1a1.5 1.5.0 100-3 1.5 1.5.0 000 3zM1 7.086a1 1 0 00.293.707L8.75 15.25l-.043.043a1 1 0 01-1.414.0l-7-7A1 1 0 010 7.586V3a1 1 0 011-1v5.086z"/></svg></span><a class="btn btn-light" href=https://gohalo.github.io/tags/rust/ role=button>rust</a>
<a class="btn btn-light" href=https://gohalo.github.io/tags/program/ role=button>program</a></div></div><hr><div class=content-body><p>这里简单介绍基本常用的语法。</p><h1 id=变量>变量 <a href=#%e5%8f%98%e9%87%8f class=anchor aria-hidden=true>#</a></h1><p>为了保证安全性，声明的变量默认就是不可变的 (immutable)，此时编译器就不需要进行跟踪了，这跟常量 (constants) 还是有所区别的。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=n>width</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w> </span><span class=c1>// immutable
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>	</span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;The width is </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>width</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>const</span><span class=w> </span><span class=no>PI</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>3.1415926</span><span class=p>;</span><span class=w> </span><span class=c1>// constants
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>	</span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;The PI is </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=no>PI</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>如果要使用变量，那么就需要通过 <code>let mut width = 10;</code> 类似的方式进行声明了。</p><p>在 Rust 中，变量可以有如下的属性：A) <code>Immutable</code> 不可变变量；B) <code>Mutable</code> 可变变量；C) <code>Shadowing</code> 重定义(遮蔽)一个变量；D) <code>Const</code> 常量；E) <code>Static</code> 静态变量。</p><h2 id=重定义>重定义 <a href=#%e9%87%8d%e5%ae%9a%e4%b9%89 class=anchor aria-hidden=true>#</a></h2><p>使用不可变变量可以重复对某个变量赋值，在其它语言里可能是重复定义，而 Rust 会覆盖之前的定义，并且允许是不同类型，但前提是需要通过 <code>let</code> 声明。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=n>spaces</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;    &#34;</span><span class=p>;</span><span class=w>        </span><span class=c1>// 字符串
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=n>spaces</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spaces</span><span class=p>.</span><span class=n>len</span><span class=p>();</span><span class=w>  </span><span class=c1>// 空格的数量，是整型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>spaces</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;    &#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=c1>//spaces = spaces.len();    // 如果要改变类型，需要使用let标识是新变量
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>最后一个意味着类型发生了变化，此时会直接报错。另外，需要注意，重定义是不能作用于 <code>static</code> 和 <code>const</code> 变量的。</p><h2 id=静态变量>静态变量 <a href=#%e9%9d%99%e6%80%81%e5%8f%98%e9%87%8f class=anchor aria-hidden=true>#</a></h2><p>一个静态变量在应用中有唯一的内存地址，通常是可变的，这样就不是线程安全的，所以在读写时需要添加 unsafe 标识。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>static</span><span class=w> </span><span class=no>LOG_L_INFO</span>: <span class=kt>i32</span> <span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>static</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=no>LOG_LEVEL</span>: <span class=kt>i32</span> <span class=o>=</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// println!(&#34;Log level {}&#34;, LOG_LEVEL); // error: use of mutable static
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;Log info </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=no>LOG_L_INFO</span><span class=p>);</span><span class=w> </span><span class=c1>// ok
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=k>unsafe</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=no>LOG_LEVEL</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>6</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;Log level </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=no>LOG_LEVEL</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=其它>其它 <a href=#%e5%85%b6%e5%ae%83 class=anchor aria-hidden=true>#</a></h2><p>常量会在编译时复制到其使用地方，所以，对于结构体较大、需要地址访问、可变，可以使用静态变量，其它建议使用常量。</p><h1 id=数据类型>数据类型 <a href=#%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b class=anchor aria-hidden=true>#</a></h1><p>如上，Rust 仍然是静态类型语言，定义变量的时候已经确定了具体类型，只是允许覆盖原有的变量。大部分情况下编译器可以推断出具体数据类型，只有少数无法确定类型的场景需要显示声明，最常见的是获取用户的输入。</p><pre tabindex=0><code>let guess: u32 = &#34;42&#34;.parse().expect(&#34;Not a number!&#34;);
</code></pre><p>在 Rust 中包含了标量 (scalar) 和复合 (compound) 两类数据子集。标量用来代表一个单独的值，包含了如下四种类型：</p><ul><li>整型，包括了有符号 (i) 和无符号 (u) 两种，可以通过数值指定位数，例如 <code>i8</code> <code>i128</code> 等，还有与 CPU 平台相关的 <code>isize</code> 。</li><li>浮点数，包括了 <code>f32</code> <code>f64</code> 两种不同精度，默认采用的是 64 位。</li><li>布尔类型，通过 <code>bool</code> 表示，与其它语言类似，只有 <code>true</code> 和 <code>false</code> 两种。</li><li>字符类型，通过 <code>char</code> 表示，不过采用的是四字节的 Unicode 编码。</li></ul><p>复合类型可以将多个值组合成一个类型，有两个原生的复合类型：A) 元组 (tuple)，长度在声明之后不再变化，可以通过解构获取变量，或者使用索引；B) 数组 (array)，每个元素类型相同，与其它语言不同，其长度是固定的。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=n>tup</span>: <span class=p>(</span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=kt>u8</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>500</span><span class=p>,</span><span class=w> </span><span class=mf>6.4</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span><span class=w> </span><span class=c1>// 等价于 let tup = (500, 6.4, 1)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>,</span><span class=w> </span><span class=n>z</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tup</span><span class=p>;</span><span class=w> </span><span class=c1>// 用于解构
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>	</span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;The third value is </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>tup</span><span class=p>.</span><span class=mi>2</span><span class=p>);</span><span class=w>  </span><span class=c1>// 访问序号从0开始
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>	
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=n>months</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=s>&#34;January&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;February&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;March&#34;</span><span class=p>];</span><span class=w> </span><span class=c1>// 字符串类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=n>arr</span>: <span class=p>[</span><span class=kt>i32</span><span class=p>;</span><span class=w> </span><span class=mi>5</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>5</span><span class=p>];</span><span class=w> </span><span class=c1>// 指定数据类型
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=n>data</span>: <span class=p>[</span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=mi>5</span><span class=p>];</span><span class=w> </span><span class=c1>// 使用默认值，等价于 [0, 0, 0, 0, 0]
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=n>value</span>: <span class=p>[</span><span class=mi>0</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>u8</span><span class=p>;</span><span class=w> </span><span class=mi>5</span><span class=p>];</span><span class=w> </span><span class=c1>// 可以指定类型和默认值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>	</span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;The first month </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>months</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span><span class=w> </span><span class=c1>// 访问方式与其它语言类似，序号从0开始
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>有个特殊的 <code>()</code> 元组，类似于其它语言中的 <code>void</code> 返回值，也可以搭配标准库中的 <code>Ok(())</code> 这种方式。</p><h2 id=切片>切片 <a href=#%e5%88%87%e7%89%87 class=anchor aria-hidden=true>#</a></h2><p>切片允许引用集合中部分连续的序列，而不是整个集合，例如内置的 <code>str</code> 和 <code>[u8]</code> 都是切片，如果直接使用 <code>let hey: str ="Hello";</code> 会报错，因为字符串切片是动态大小，编译期间无法获取其大小，只有运行时才可以确定，对于强类型、强安全的 Rust 语言是不可接受的。</p><p>因为底层切片长度是可以动态变化，编译期间无法获取其具体长度，所以只能分配到堆上，而不能使用栈，也就只能通过引用在栈上使用。
另外，需要注意 <code>let arr: [i8; 4] = [1, 2, 3, 4];</code> 是定长的，可以保存在栈中，与切片的区别就是显式指定了长度。</p><h2 id=枚举>枚举 <a href=#%e6%9e%9a%e4%b8%be class=anchor aria-hidden=true>#</a></h2><p>Rust 中的枚举跟很多函数编程语言中的代数数据类型比较相似，可以添加变量、定义接口等，而且提供了一个极为强大的控制流运算符。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>enum</span> <span class=nc>IPAddr</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>V4</span><span class=p>(</span><span class=kt>u8</span><span class=p>,</span><span class=w> </span><span class=kt>u8</span><span class=p>,</span><span class=w> </span><span class=kt>u8</span><span class=p>,</span><span class=w> </span><span class=kt>u8</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>V6</span><span class=p>(</span><span class=nb>String</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Vx</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>impl</span><span class=w> </span><span class=n>IPAddr</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>fn</span> <span class=nf>dump</span><span class=p>(</span><span class=o>&amp;</span><span class=bp>self</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>String</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>match</span><span class=w> </span><span class=bp>self</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>IPAddr</span>::<span class=n>V4</span><span class=p>(</span><span class=n>i1</span><span class=p>,</span><span class=w> </span><span class=n>i2</span><span class=p>,</span><span class=w> </span><span class=n>i3</span><span class=p>,</span><span class=w> </span><span class=n>i4</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=fm>format!</span><span class=p>(</span><span class=s>&#34;</span><span class=si>{}</span><span class=s>.</span><span class=si>{}</span><span class=s>.</span><span class=si>{}</span><span class=s>.</span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>i1</span><span class=p>,</span><span class=w> </span><span class=n>i2</span><span class=p>,</span><span class=w> </span><span class=n>i3</span><span class=p>,</span><span class=w> </span><span class=n>i4</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>IPAddr</span>::<span class=n>V6</span><span class=p>(</span><span class=n>val</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>val</span><span class=p>.</span><span class=n>to_string</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;Unknown&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>loopbackx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>IPAddr</span>::<span class=n>Vx</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>loopback4</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>IPAddr</span>::<span class=n>V4</span><span class=p>(</span><span class=mi>127</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>loopback6</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>IPAddr</span>::<span class=n>V6</span><span class=p>(</span><span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;::1&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;IPvx </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>loopbackx</span><span class=p>.</span><span class=n>dump</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;IPv4 </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>loopback4</span><span class=p>.</span><span class=n>dump</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;IPv6 </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>loopback6</span><span class=p>.</span><span class=n>dump</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>另外，还有一个 <code>if let</code> 的语法糖，用于将 <code>match</code> 只需要单个匹配的语句进行简化。</p><h1 id=函数>函数 <a href=#%e5%87%bd%e6%95%b0 class=anchor aria-hidden=true>#</a></h1><p>使用的变量和函数名统一使用 snake case 风格进行命名，也就是所有字母小写并使用下划线分隔；参数需要通过注解显式声明，编译器在运行时会直接使用；返回值的类型可以通过 <code>-></code> 后指定。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>sum_int</span><span class=p>(</span><span class=n>x</span>: <span class=kt>i64</span><span class=p>,</span><span class=w> </span><span class=n>y</span>: <span class=kt>i64</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>i64</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>y</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;Sum return </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>sum_int</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>另外，Rust 的函数体是基于表达式的，与其它语言有所不同，而且比较难理解。</p><blockquote><p>表达式 (Expressions) 会计算并产生一个值，而语句 (Statements) 是执行一些操作但不返回值的指令，包括了：A) 声明语句，包括变量、常量、结构体、函数等的声明，以及通过 <code>extern</code> 和 <code>use</code> 关键字引入；B) 表达式语句，专指以分号结尾的表达式，返回单元类型。</p><p>对于表达式语句会将求值结果抛弃，总是返回单元类型 <code>()</code>，这一概念来自 OCmal，其唯一的值就是其本身，表示没有特殊价值。如果作为函数返回值，则表示该函数无返回值，通常也就不需要在签名中指定返回类型。</p></blockquote><p>例如，在 Rust 中不允许通过 <code>let x = (let y = 0);</code> 定义多个变量，包括了 <code>let x = y = 0;</code> 这种方式，因为 <code>let x = 0</code> 语句不会返回值，而其它语言则会返回值。</p><p>另外，大部分的 Rust 代码都是由表达式组成，例如语句 <code>let y = 6;</code> 中的 <code>6</code> 是一个表达式，它计算出的值是 <code>6</code>；数学运算 <code>5 + 6</code> 也是表达式；还有函数调用、宏调用、大括号等，也都是表达式。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>sum_int</span><span class=p>(</span><span class=n>x</span>: <span class=kt>i64</span><span class=p>,</span><span class=w> </span><span class=n>y</span>: <span class=kt>i64</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>i64</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>y</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;Brace </span><span class=si>{}</span><span class=s>, Sum </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>,</span><span class=w> </span><span class=n>sum_int</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>上述代码展示了大括号的返回，需要注意上述都没有使用分号 <code>;</code> 结束，现在是表达式，如果使用，那么就是语句了，此时不会返回值，直接报错。</p><h2 id=永不返回>永不返回 <a href=#%e6%b0%b8%e4%b8%8d%e8%bf%94%e5%9b%9e class=anchor aria-hidden=true>#</a></h2><p>当使用 <code>!</code> 作为返回类型的时候，就表示该函数永不返回，通常用在会导致程序退出的函数或者是一个死循环。</p><h1 id=控制流>控制流 <a href=#%e6%8e%a7%e5%88%b6%e6%b5%81 class=anchor aria-hidden=true>#</a></h1><p>包含了分支和循环两类，分支也就是 <code>if else</code> 语句，而循环包含了 <code>loop</code> <code>while</code> 和 <code>for</code> 三种。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=kc>true</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>9</span><span class=w> </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;number is divisible by 4&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;number is divisible by 3&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;number is not divisible by 4 or 3&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=na>&#39;counter</span>: <span class=nc>loop</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;count </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>count</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>remaining</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>result</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>loop</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;remaining </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>remaining</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=n>remaining</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>9</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=w> </span><span class=n>remaining</span><span class=p>;</span><span class=w> </span><span class=c1>// 退出内层循环并返回值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=n>count</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=w> </span><span class=nl>&#39;counter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>remaining</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>count</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;ending result </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>result</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;ending count </span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>count</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>while</span><span class=w> </span><span class=n>number</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;</span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>number</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>number</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=c1>// 反向输出
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=n>number</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=o>..</span><span class=mi>4</span><span class=p>).</span><span class=n>rev</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;</span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>number</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p><code>while</code> 和 <code>for</code> 的使用方式与其它语言基本类似，比较特殊的稍作说明：<code>if else</code> 可以用在单条语句中；<code>loop</code> 允许设置标签指定 <code>continue</code> 和 <code>break</code> 作用的循环位置，而且可以返回值。</p><h1 id=其它-1>其它 <a href=#%e5%85%b6%e5%ae%83-1 class=anchor aria-hidden=true>#</a></h1><h2 id=属性>属性 <a href=#%e5%b1%9e%e6%80%a7 class=anchor aria-hidden=true>#</a></h2><p>可以应用于模块、crate、函数的元数据，与 Java 中的注解有点类似，如果要应用于整个 crate 语法为 <code>#![attribute]</code>，否则为 <code>#[attribute]</code> 配置，而且属性可以接受参数，例如 <code>#[attribute="value"]</code> <code>#[attribute(key="value")]</code> <code>#[attribute(value)]</code> 都可以。</p><p>如下是常用的用途：</p><ul><li>禁用 lint 警告，<code>allow(dead_code, unused)</code> 。</li><li>条件编译代码，<code>cfg(target_os="linux")</code> 。
条件可以使用取非，例如 <code>cfg(not(target_os="linux"))</code> 当目标系统不是 Linux 时才会编译。</li></ul><h2 id=打印>打印 <a href=#%e6%89%93%e5%8d%b0 class=anchor aria-hidden=true>#</a></h2><p>可以通过 <code>std::fmt</code> 中的一系列宏进行格式化，包括了 <code>format!</code> <code>print!</code> <code>eprint!</code> 分别输出到字符串、标准输出、标准错误输出，默认 Rust 编译时会进行类型推断，也可以手动指定。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 简单通过fmt::Display格式化显示
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;Hello </span><span class=si>{}</span><span class=s>, this is </span><span class=si>{}</span><span class=s>.&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Bob&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Andy&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 可以通过序号、关键字指定格式化显示内容
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;Hello </span><span class=si>{0}</span><span class=s>, this is </span><span class=si>{1}</span><span class=s>. I&#39;m </span><span class=si>{self}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Bob&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Andy&#34;</span><span class=p>,</span><span class=w> </span><span class=bp>self</span><span class=o>=</span><span class=s>&#34;Alice&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 通过:可以在右侧定制格式化方式
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;right align </span><span class=si>{num:&gt;width$}</span><span class=s>, </span><span class=si>{num:&gt;0width$}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>num</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>width</span><span class=o>=</span><span class=mi>3</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;0x</span><span class=si>{num:x}</span><span class=s> 0o</span><span class=si>{num:o}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>num</span><span class=o>=</span><span class=mh>0xdeadbeef</span><span class=k>i64</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>另外，通过 <code>{:?}</code> <code>{:#?}</code> 可以打印调试信息，对应 <code>fmt::Debug</code> 的实现，后者会通过一些换行美化显示，而且可以通过 <code>#[derive(Debug)]</code> 属性自动推导。如果通过 <code>{}</code> 打印，则需要实现 <code>fmt::Didplay</code> Trait 方法，否则会报错。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>fmt</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>#[derive(Debug)]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>struct</span> <span class=nc>Complex</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>real</span>: <span class=kt>f64</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>image</span>: <span class=kt>f64</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>impl</span><span class=w> </span><span class=n>fmt</span>::<span class=n>Display</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>Complex</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>fn</span> <span class=nf>fmt</span><span class=p>(</span><span class=o>&amp;</span><span class=bp>self</span><span class=p>,</span><span class=w> </span><span class=n>f</span>: <span class=kp>&amp;</span><span class=nc>mut</span><span class=w> </span><span class=n>fmt</span>::<span class=n>Formatter</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>fmt</span>::<span class=nb>Result</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=fm>write!</span><span class=p>(</span><span class=n>f</span><span class=p>,</span><span class=w> </span><span class=s>&#34;{} + {}i&#34;</span><span class=p>,</span><span class=w> </span><span class=bp>self</span><span class=p>.</span><span class=n>real</span><span class=p>,</span><span class=w> </span><span class=bp>self</span><span class=p>.</span><span class=n>image</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Complex</span><span class=p>{</span><span class=n>real</span>: <span class=mf>10.0</span><span class=p>,</span><span class=w> </span><span class=n>image</span>: <span class=mf>20.0</span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;</span><span class=si>{0:?}</span><span class=s> </span><span class=si>{0:#?}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>num</span><span class=p>);</span><span class=w> </span><span class=c1>// 直接使用属性打印即可
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;</span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>num</span><span class=p>);</span><span class=w> </span><span class=c1>// 需要fmt::Display Trait实现
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>简单来说，通过 <code>{}</code> 打印需要用户指定，而 <code>{:?}</code> 要更详细，而且可以通过 <code>#[derive(Debug)]</code> 宏简单实现。</p></div></div></div></article><div class=related-posts><hr><div class="row justify-content-center"><div class=col><h2 class=section-title>相关阅读</h2></div></div><ul><li><a class=text-body href=/cn/blog/rust-handle-error/>Rust 中的错误处理</a></li><li><a class=text-body href=/cn/blog/rust-basic-introduce/>Rust 基本介绍</a></li><li><a class=text-body href=/cn/blog/bash-pitfalls/>Bash 使用常见错误以及规避措施</a></li></ul></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="order-first order-lg-last text-center"><ul class=list-inline><li class=list-inline-item><a href=/privacy-policy/>隐私声明</a></li></ul></div></div><div class=row><div class=text-center>Built by GoHalo, generated with <a class=text-muted href=https://gohugo.io>Hugo</a>, and hosted on GitHub Pages</div></div><div class=row><div class=text-center>Copyright © 2013-2024 GoHalo. All Rights Reserved.</div></div></div></footer></body></html>