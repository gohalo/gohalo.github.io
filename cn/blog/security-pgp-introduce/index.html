<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>PGP 简介 | GoHalo</title><link rel=apple-touch-icon sizes=180x180 href=https://gohalo.github.io/favicon/apple-touch-icon.png><link rel=icon href=https://gohalo.github.io/favicon/favicon.ico sizes=any><link rel=icon type=image/png sizes=32x32 href=https://gohalo.github.io/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://gohalo.github.io/favicon/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://gohalo.github.io/favicon/site.webmanifest><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=google-site-verification content="p7jJ5d3kF9yxRhpIo5GgHXAZ1ATKVyZhV2kf6mEGOv0"><meta name=description content="GnuPGP 是一个基于公钥加密体系的加密软件，功能强大，有很快的速度，而且源码是免费的。
这里简单介绍下 PGP 相关内容。
"><link rel=stylesheet href=https://gohalo.github.io/font-awesome/css/font-awesome.min.css><link rel=stylesheet href=/css/syntax.min.c70103877c799b924f50023b6b01eca010d7e2808885a74f9ea662cc47379ae1.css integrity="sha256-xwEDh3x5m5JPUAI7awHsoBDX4oCIhadPnqZizEc3muE=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.c4814ac9dc5fab259f313a787ded4f8e.css integrity="md5-xIFKydxfqyWfMTp4fe1Pjg==" crossorigin=anonymous><style type=text/css>.main p{text-indent:2em}.main li p{text-indent:0}</style><noscript><style>img.lazyload{display:none}</style></noscript></head><body><div class=sticky-top><div class=header-bar></div><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/cn aria-label=GoHalo>GoHalo</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>项目</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a class=dropdown-item href=/cn/project/bastion/>Bastion</a></li><li><a class="dropdown-item disabled" href=/cn/project/bootserver/>BootServer</a></li></ul></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/>博客</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/archives/>归档</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/tags/>标签</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/slide/>幻灯片</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/docs/>文档</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn dropdown-toggle" id=header-languages data-bs-toggle=dropdown aria-expanded=false data-bs-display=static>
中文</button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=header-languages><li><a class=dropdown-item rel=alternate href=https://gohalo.github.io/en hreflang=en lang=en>English</a></li></ul></div><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=/cn/about><i class="fa fa-user" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/gohalo title=GitHub><i class="fa fa-github-alt" aria-hidden=true></i></a></li><li class=nav-item><button id=mode class="btn nav-link social-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><i class="fa fa-star" aria-hidden=true></i></span>
<span class=toggle-light><i class="fa fa-cog" aria-hidden=true></i></span></button></li></ul></div></div></nav></div><div class="main container-xxl" role=document><div class="blog row"><div class="col-md-12 col-xl-9 mt-4"><div class=header><h1>PGP 简介</h1><div class="meta mb-3"><i class="fa fa-calendar" aria-hidden=true></i>
<span class=mx-2>2016-10-21</span>
<i class="fa fa-tags" aria-hidden=true></i>
<a class=text-body href=https://gohalo.github.io/cn/tags/linux/ role=button>linux</a>
<a class=text-body href=https://gohalo.github.io/cn/tags/security/ role=button>security</a>
<a class=text-body href=https://gohalo.github.io/cn/tags/command/ role=button>command</a></div></div><hr><div class=content><p>GnuPGP 是一个基于公钥加密体系的加密软件，功能强大，有很快的速度，而且源码是免费的。</p><p>这里简单介绍下 PGP 相关内容。</p><a class=anchor id=简介></a><h1>简介 <a href=#%e7%ae%80%e4%bb%8b aria-hidden=true>#</a></h1><p>Pretty Good Privacy, PGP 加密由一系列散列、数据压缩、对称密钥加密，以及公钥加密的算法组合而成，遵守 OpenPGP 数据加密标准 <a href=http://tools.ietf.org/rfc/rfc4880.txt>RFC 4880</a> ，每个步骤支持几种算法，可以选择一个使用。</p><p>注意 PGP 是一个商用软件，对应的开源软件为 GnuPGP ，两者都遵守 OpenPGP 标准。</p><p><img alt="pgp diagram" src=images/pgp-diagram.png class="mx-auto d-block"></p><p>通常，使用如上的加密和解密过程大致为。</p><ol><li>用户产生需要加密的信息。</li><li>OpenPGP 发送方产生一串随机数，作为对称加密密钥，这一随机数只对该信息或该会话有效。</li><li>使用接受者的公钥加密上述的随机数 (密钥)，放置到需要发送消息的开头。</li><li>通过上述产生的随机数加密需要加密的信息，通常会先对信息进行压缩。</li><li>接收方则会先通过私钥解密随机数，然后解密信息。</li></ol><p>当然，也可以先产生一个数字签名，并将数字签名添加到信息中，然后同样会通过随机串加密。在 OpenPGP 中也可以对信息进行压缩，通常压缩是在获得数字签名后且在压缩之前。</p><blockquote><p>The Public-Key Cryptography Standards(PKCS) 是由美国 RSA 数据安全公司及其合作伙伴制定的一组公钥密码学标准，包括证书申请、证书更新、证书作废表发布、扩展证书内容以及数字签名、数字信封的格式等方面的一系列相关协议。</p></blockquote><a class=anchor id=信任模型></a><h2>信任模型 <a href=#%e4%bf%a1%e4%bb%bb%e6%a8%a1%e5%9e%8b aria-hidden=true>#</a></h2><p>PGP 的好处在于它的信任模型 Web Trust Model，一种非常贴近生活中人与人的信任模型。在信息世界里面，人与人之间的信任纽带有两种方式被建立。</p><a class=anchor id=集中式></a><h4>集中式 <a href=#%e9%9b%86%e4%b8%ad%e5%bc%8f aria-hidden=true>#</a></h4><p>如 CA 结构，大家都信任 CA ，于是 Peter 是不是 Peter ，是根据 CA 是否认识这个 Peter ，我们现在通常所说的的数字证书认证，就是这种集中认证的模式。</p><a class=anchor id=分布式></a><h4>分布式 <a href=#%e5%88%86%e5%b8%83%e5%bc%8f aria-hidden=true>#</a></h4><p>假设没有CA，只信任自己和朋友，每个人都是在一个朋友圈子中，朋友圈子以外的人，则需要一个中间人作为介绍人，这就是现实的生活。</p><p>我有一个朋友叫 Andy，且我有另一个朋友叫 Bob，如果 Bob 想认识 Andy，于是他想通过我来认识 Andy，方法很简单，鉴于我认识他们两者，通过我为 Bob 的公钥签名，于是 Andy 可以直接向 Bob 证明他是我的朋友。</p><p>PGP 采用的后者是这种方式，每个人都以自己为中心，然后是朋友圈，然后是朋友的朋友。</p><a class=anchor id=gnupgp></a><h1>GnuPGP <a href=#gnupgp aria-hidden=true>#</a></h1><p>公钥算法的关键点在于如何传播公钥，如果有恶意用户传递了一把虚假公钥，此时，如果别人不知就里，用这把公钥加密信息，持有该虚假钥匙的侵入者就可以解密而读到信息。而如果侵入者再将解密的讯息加以修改，并以真正的公开钥匙加密，然后传送出去，这种进攻无法被发现。</p><p>PGP 的解决方法是对公钥进行签名，也即生成指纹 (fingerprint)，只有公钥会有指纹。每个公钥均绑定唯一的用户身份 (包括用户名、注释、邮箱)，当然一个人的公钥可以由别人来签名，<strong>签名 (指纹) 是用来测试该公钥是否是由其声明的用户发出的</strong> 。</p><p>至于有多信任这些签名，完全取决于 GPG 用户，当你信任给这把钥匙签名的人时，你认为这把钥匙是可信的，并确信这把钥匙确实属于拥有相应用户身份的人。只有当你信任签名者的公开钥匙时，你才能信任这个签名。要想绝对确信一把钥匙是正确和真实的，你就得在给予绝对信任之前，通过可靠渠道比较钥匙的 &ldquo;指纹&rdquo;。</p><a class=anchor id=使用></a><h2>使用 <a href=#%e4%bd%bf%e7%94%a8 aria-hidden=true>#</a></h2><p>在 <code>~/.gnupg</code> 目录下，保存了一些必须的文件，其中密钥以加密形式存储在磁盘上，包括了两个文件，一个存储公钥 (<code>pubring.gpg</code>)、一个存储私钥 (<code>secring.gpg</code>)。</p><p>GPG 会通过 username、comment、email 生成一个 UID(hash value)，在使用时可以用其中的一种方式。</p><a class=anchor id=1-生成密钥对-公钥私钥></a><h4>1. 生成密钥对 (公钥+私钥) <a href=#1-%e7%94%9f%e6%88%90%e5%af%86%e9%92%a5%e5%af%b9-%e5%85%ac%e9%92%a5%e7%a7%81%e9%92%a5 aria-hidden=true>#</a></h4><p>生成时需要选择 A) 加密算法、密钥长度 (长度越长解密时间越长，不过也会更安全)、密钥的有效时间；B) 区分该密钥对的用户名、e-mail、注释 (这些信息是可以修改的)；C) 一个保护该私钥的验证密码。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gpg --gen-key
</span></span><span class=line><span class=cl>Please select what kind of key you want:                  # 选择加密以及指纹算法
</span></span><span class=line><span class=cl>   (1) RSA and RSA (default)
</span></span><span class=line><span class=cl>   (2) DSA and Elgamal
</span></span><span class=line><span class=cl>   (3) DSA (sign only)
</span></span><span class=line><span class=cl>   (4) RSA (sign only)
</span></span><span class=line><span class=cl>Your selection? 1
</span></span><span class=line><span class=cl>RSA keys may be between 1024 and 4096 bits long.
</span></span><span class=line><span class=cl>What keysize do you want? (2048)
</span></span><span class=line><span class=cl>Requested keysize is 2048 bits
</span></span><span class=line><span class=cl>Please specify how long the key should be valid.
</span></span><span class=line><span class=cl>         0 = key does not expire
</span></span><span class=line><span class=cl>      &lt;n&gt;  = key expires in n days
</span></span><span class=line><span class=cl>      &lt;n&gt;w = key expires in n weeks
</span></span><span class=line><span class=cl>      &lt;n&gt;m = key expires in n months
</span></span><span class=line><span class=cl>      &lt;n&gt;y = key expires in n years
</span></span><span class=line><span class=cl>Key is valid for? (0)
</span></span><span class=line><span class=cl>Key does not expire at all
</span></span><span class=line><span class=cl>Is this correct? (y/N) y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>GnuPG needs to construct a user ID to identify your key.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Real name: foobar
</span></span><span class=line><span class=cl>Email address: foobar@ooops.com
</span></span><span class=line><span class=cl>Comment: just for test
</span></span><span class=line><span class=cl>You selected this USER-ID:
</span></span><span class=line><span class=cl>    &#34;foobar (just for test) &lt;foobar@ooops.com&gt;&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
</span></span><span class=line><span class=cl>You need a Passphrase to protect your secret key.         # 输入密码
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gpg: key FCC7A473 marked as ultimately trusted            # 用户的hash值，可以用来替代userid
</span></span><span class=line><span class=cl>public and secret key created and signed.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gpg: checking the trustdb
</span></span><span class=line><span class=cl>gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model
</span></span><span class=line><span class=cl>gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
</span></span><span class=line><span class=cl>pub   2048R/FCC7A473 2016-07-06
</span></span><span class=line><span class=cl>      Key fingerprint = ACB2 B707 B2D8 A548 55A8  5E24 A5CC BA5C FCC7 A473   # 可以用来电话验证^_^
</span></span><span class=line><span class=cl>uid                  foobar (just for test) &lt;foobar@ooops.com&gt;               # 三元素组成userid
</span></span><span class=line><span class=cl>sub   2048R/3B44DA00 2016-07-06
</span></span></code></pre></div><p>生成的公钥 (<code>pubring.gpg</code>)、私钥 (<code>secring.gpg</code>) 保存在 <code>~/.gnupg/</code> 目录下。</p><a class=anchor id=2-撤销公钥></a><h4>2. 撤销公钥 <a href=#2-%e6%92%a4%e9%94%80%e5%85%ac%e9%92%a5 aria-hidden=true>#</a></h4><p>当密钥对生成之后，应该立即做一个公钥回收证书，当忘记了私钥的口令或者私钥丢失或被盗窃，可以发布这个证书来声明以前的公钥不再有效。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gpg --output revoke.asc --gen-revoke &#34;user-name/e-mail/user-id&#34;           # 生成回收证书，以备不时之需
</span></span><span class=line><span class=cl>$ gpg --import revoke.asc                              # 导入回收证书
</span></span><span class=line><span class=cl>$ gpg --keyserver keys.gnugp.net --send &#34;8D253E8A&#34;     # 发送回收证书到服务器，声明原GPG Key作废
</span></span></code></pre></div><p>当然如果要这么做，一定要先有私钥，否则任何人都能取消你的公钥。</p><a class=anchor id=3-传播公钥></a><h4>3. 传播公钥 <a href=#3-%e4%bc%a0%e6%92%ad%e5%85%ac%e9%92%a5 aria-hidden=true>#</a></h4><p>导出公钥之后，就可以通过一些可靠的方式传播公钥。可以将公钥通过 e-mail 发送给好友，或者上传到指定的服务器(如果不指定使用默认的 <a href=http://keys.gnupg.net>keys.gnupg.net</a> ，其它的还有 <a href=http://keyserver.ubuntu.com/>keyserver.ubuntu.com</a> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gpg --keyserver keys.gnugp.net --send-keys &#34;8D253E8A&#34;                     # 上传到服务器
</span></span><span class=line><span class=cl>$ gpg --fingerprint                                                         # 打印公钥指纹
</span></span><span class=line><span class=cl>$ gpg --keyserver keys.gnugp.net --search-keys &#34;user-name/e-mail/user-all&#34;  # 在服务器上查找
</span></span></code></pre></div><p>由于公钥服务器没有检查机制，任何人都可以用你的名义上传公钥，所以没有办法保证服务器上的公钥的可靠性。通常，可以在网站上公布一个公钥指纹，让其他人核对下载到的公钥是否为真。</p><a class=anchor id=4-查看密钥></a><h4>4. 查看密钥 <a href=#4-%e6%9f%a5%e7%9c%8b%e5%af%86%e9%92%a5 aria-hidden=true>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gpg --list-keys                       # 输出现有公钥，包括UID、公私钥的HASH值，等同于gpg -k
</span></span><span class=line><span class=cl>$ gpg --list-sigs                       # 同时显示签名，实际也就是上述的HASH值
</span></span><span class=line><span class=cl>$ gpg --fingerprint                     # 输出公钥的指纹
</span></span><span class=line><span class=cl>$ gpg --list-secret-keys                # 列出私钥，PS. 列出私钥的指纹和签名根本就没用，等同于gpg -K
</span></span></code></pre></div><p>通过 <code>gpg -k</code> 列出所有公钥，其中第一行表示保存的文件名 (<code>pubring.gpg</code>)；第二行为公钥的特征 (加密方式:如 <code>2048R</code> 表示 <code>2048-bit RSA</code>，<code>user-id</code> 的 <code>hash</code> 值，生成时间)；第三行表示用户 ID ；第四行表示私钥特征。</p><a class=anchor id=5-导出公钥></a><h4>5. 导出公钥 <a href=#5-%e5%af%bc%e5%87%ba%e5%85%ac%e9%92%a5 aria-hidden=true>#</a></h4><p>将指定用户的公钥以 ASCII 的格式导出。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gpg --armor --export &#34;user-name/e-mail/user-id&#34;                           # 导出ASCII公钥到终端
</span></span><span class=line><span class=cl>$ gpg --armor --output public-key.gpg --export &#34;user-name/e-mail/user-id&#34;   # 导出ASCII公钥到文件，或者-o
</span></span><span class=line><span class=cl>$ gpg --armor --export-secret-keys                                          # 导出私钥
</span></span><span class=line><span class=cl>$ gpg --refresh-keys                                                        # 从服务器定期更新公钥
</span></span></code></pre></div><p>其中 <code>--armor</code> 表示将内容转换成可见的 ASCII 码输出，否则是二进制不方便阅读。</p><a class=anchor id=6-导入公钥></a><h4>6. 导入公钥 <a href=#6-%e5%af%bc%e5%85%a5%e5%85%ac%e9%92%a5 aria-hidden=true>#</a></h4><p>除了生成自己的密钥，还需要别人的公钥，用于生成加密信息或者验证数字签名等。为此，就需要将他人的公钥或者你的其他密钥输入系统，这时可以使用 import 参数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gpg --import public-key.gpg                                                       # 导入ASCII公钥到文件
</span></span><span class=line><span class=cl>$ gpg --keyserver hkp://subkeys.pgp.net --search-keys &#34;user-name/e-mail/user-all&#34;   # 从服务器查看然后选择
</span></span><span class=line><span class=cl>$ gpg --keyserver subkeys.gpg.net --recv-keys 8D253E8A                              # 直接导入
</span></span></code></pre></div><p>由于任何人都可以导入公钥，我们无法保证服务器上的公钥是否可靠，下载后还需要用其他机制验证，如数字签字。</p><a class=anchor id=7-删除密钥></a><h4>7. 删除密钥 <a href=#7-%e5%88%a0%e9%99%a4%e5%af%86%e9%92%a5 aria-hidden=true>#</a></h4><p>我们可以通过如下命令删除密钥。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gpg --delete-keys &#34;user-name/e-mail/user-id&#34;                    # 从公钥钥匙环里删除密钥
</span></span><span class=line><span class=cl>$ gpg --delete-secret-keys &#34;user-name/e-mail/user-id&#34;             # 从私钥钥匙环里删除密钥
</span></span><span class=line><span class=cl>$ gpg --delete-secret-and-public-key &#34;user-name/e-mail/user-id&#34;   # 同时删除公钥私钥
</span></span></code></pre></div><a class=anchor id=8-修改密钥></a><h4>8. 修改密钥 <a href=#8-%e4%bf%ae%e6%94%b9%e5%af%86%e9%92%a5 aria-hidden=true>#</a></h4><p>用此命令你可以修改钥匙的失效日期，加进一个指纹，对钥匙签名等等。 尽管显得太清楚而不用提，这里还是要说，要做以上事情你得用你的通行句。 敲入通行句后，你会见到命令行。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gpg --edit-key &#34;user-name/e-mail/user-id&#34;
</span></span></code></pre></div><a class=anchor id=9-加密解密></a><h4>9. 加密/解密 <a href=#9-%e5%8a%a0%e5%af%86%e8%a7%a3%e5%af%86 aria-hidden=true>#</a></h4><p>在安装和按照需要设置好所有事以后，我们就可以开始加密和解密了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gpg --recipient &#34;8D253E8A&#34; --output demo.en.txt --encrypt demo.txt   # 用指定用户公钥加密
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ gpg --output demo.de.txt --decrypt demo.en.txt                       # 解密，可以不指定用户名
</span></span><span class=line><span class=cl>$ gpg demo.en.txt                                                      # 解密，最简单方式
</span></span></code></pre></div><p><code>--recipient</code> 参数指定接收者的公钥，<code>--output</code> 指定加密后的文件名，<code>--encrypt</code> 指定源文件。</p><a class=anchor id=10-签名></a><h4>10. 签名 <a href=#10-%e7%ad%be%e5%90%8d aria-hidden=true>#</a></h4><p>有时只需要对文件签名，表示这个文件确实是我本人发出的。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gpg --sign demo.txt                   # 生成二进制签名demo.txt.gpg，同时包含文本内容
</span></span><span class=line><span class=cl>$ gpg --clearsign demo.txt              # 生成ASCII的签名文件demo.txt.asc，同时包含文本内容
</span></span><span class=line><span class=cl>$ gpg --detach-sign demo.txt            # 只生成二进制签名demo.txt.sig
</span></span><span class=line><span class=cl>$ gpg --armor --detach-sign demo.txt    # 只生成ASCII签名demo.txt.asc
</span></span><span class=line><span class=cl>$ gpg --verify demo.txt.asc demo.txt    # 验证解密的文件与签名是否相符
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ gpg --armor --detach-sign -u UID demo.txt    # 可以指定用户
</span></span></code></pre></div><a class=anchor id=11-签名加密></a><h4>11. 签名+加密 <a href=#11-%e7%ad%be%e5%90%8d%e5%8a%a0%e5%af%86 aria-hidden=true>#</a></h4><p>此时签名和加密同时保存在同一个文件中。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gpg --local-user &#34;user-name/e-mail/user-id&#34; --recipient &#34;8D253E8A&#34; --armor --sign --encrypt demo.txt
</span></span><span class=line><span class=cl>$ gpg demo.txt.asc                      # 解密
</span></span></code></pre></div><a class=anchor id=公钥的管理></a><h2>公钥的管理 <a href=#%e5%85%ac%e9%92%a5%e7%9a%84%e7%ae%a1%e7%90%86 aria-hidden=true>#</a></h2><p>正如前言所提到的，这个系统有一个最大的薄弱点，那就是公钥的真实性问题。可以通过直接向公钥的提供者当面或者电话验证指纹，从而确定公钥的真实性问题。</p><p>当确定了公钥的真实性之后可以对公钥签名，表示你绝对确信这把钥匙是真实的，有了这个保证，用户就可以开始放心用这把钥匙加密了。</p><p>要对一把钥匙签名，用 <code>gpg --edit-key UID</code> ，然后用 sign 命令。</p><p>GPG 会根据现有的签名和对 &ldquo;主人的信任度&rdquo; 来决定钥匙的真实性，包括了四个值。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1 = 我不知道
</span></span><span class=line><span class=cl>2 = 我不信任（这把钥匙）
</span></span><span class=line><span class=cl>3 = 我勉强信任
</span></span><span class=line><span class=cl>4 = 我完全信任
</span></span></code></pre></div><p>对于用户不信任的签名，就会将废弃这个签名不用。注意这些信任信息不是存在储存钥匙的文件里，而是存在另一个文件里。</p><a class=anchor id=参考></a><h1>参考 <a href=#%e5%8f%82%e8%80%83 aria-hidden=true>#</a></h1><p>关于如何使用 subkey <a href=https://www.void.gr/kargig/blog/2013/12/02/creating-a-new-gpg-key-with-subkeys/>Creating a new GPG key with subkeys</a> 一个不错的介绍，可以参考 <a href=/reference/security/Creating_a_new_GPG_key_with_subkeys.maff>本地文档</a>；另一篇参考的是最佳实践，可以参考 <a href=https://help.riseup.net/en/security/message-security/openpgp/best-practices>OpenPGP Best Practices</a> ，或者 <a href=/reference/security/OpenPGP_Best_Practices.maff>本地文档</a> 。</p><p>一个官方的中文文档 <a href=https://www.gnupg.org/howtos/zh/index.html>GnuPG 袖珍 HOWTO</a> ，或者英文版 <a href=https://www.gnupg.org/gph/en/manual.html>The GNU Privacy Handbook</a> 。</p></div></div><div class="sidebar col-xl-3 mt-2"><div id=toc class=position-fixed><nav id=TableOfContents><ul><li><a href=#简介>简介</a><ul><li><a href=#信任模型>信任模型</a></li></ul></li><li><a href=#gnupgp>GnuPGP</a><ul><li><a href=#使用>使用</a></li><li><a href=#公钥的管理>公钥的管理</a></li></ul></li><li><a href=#参考>参考</a></li></ul></nav></div></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class=text-center>Built by GoHalo, generated with <a class=text-muted href=https://gohugo.io>Hugo</a>, and hosted on GitHub Pages</div></div><div class=row><div class=text-center>Copyright © 2013-2025 GoHalo. All Rights Reserved.</div></div></div></footer><script src=https://gohalo.github.io/bootstrap/js/bootstrap.bundle.min.js></script>
<script src=/main.b9cbcb174709877512d64e24f297f66a40c8d91c9a81128cb04bdd7b10247df8.js integrity="sha256-ucvLF0cJh3US1k4k8pf2akDI2RyagRKMsEvdexAkffg=" crossorigin=anonymous></script>
<a href=# class="btn btn-light btn-lg backtop" title=返回顶部><i class="fa fa-angle-double-up" aria-hidden=true></i></a></body></html>