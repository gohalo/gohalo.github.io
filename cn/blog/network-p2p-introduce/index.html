<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>P2P 协议简介 | GoHalo</title><link rel=apple-touch-icon sizes=180x180 href=https://gohalo.github.io/favicon/apple-touch-icon.png><link rel=icon href=https://gohalo.github.io/favicon/favicon.ico sizes=any><link rel=icon type=image/png sizes=32x32 href=https://gohalo.github.io/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://gohalo.github.io/favicon/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://gohalo.github.io/favicon/site.webmanifest><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=google-site-verification content="p7jJ5d3kF9yxRhpIo5GgHXAZ1ATKVyZhV2kf6mEGOv0"><meta name=description content="不同于传统的 C/S 服务模型，取消了中心服务器，每个节点都可以作为客户端和服务端。
简介 # BitTorrent 实际上是一个协议族，其基本协议是 BEP-3 ，其它的大部分协议都是围绕这个来进行扩展或补充。
如果要通过 P2P 协议进行下载，必须要包含如下的几个文件：
种子文件，一般后缀为 .torrent ，本质上是一个由 bencode 编码的文本文件，把资源分成很多虚拟块，并记录每个块的 hash 值，还包括了文件大小、名字、Tracker服务器等信息。 BT 客户端，也就是专门解析 BT 协议的程序，例如迅雷、电驴等。 Tracker 服务器，记录着 Peer 和种子相关信息，起着中心调控的作用。 在下载资源的时候，大致的流程如下：
客户端解码种子文件，得到 Tracker 服务器的地址和资源信息； 通过和 Tracker 服务器沟通得到其它已经下载该资源的 Peers 信息； 再和这些 Peers 沟通得到自己想要的部分。 可以看到，在上述的流程中，Tracker 是整个流程的关键部分，如果不能通过 Tracker 读取到 Peers 的相关信息，那么也就无法下载资源。
DHT 协议 # 为了弥补 Tracker 的单点问题，于是出现了 Distributed Hash Table, DHT 协议，该协议基于 Kademlia 建立。
参考 # 一个资源嗅探器的网站 bthub.io 。 官方网站 bittorrent.org 包括了很多相关协议的开发文档。 一个传输可视化的示例网站 mq8.org 。 "><link rel=stylesheet href=https://gohalo.github.io/font-awesome/css/font-awesome.min.css><link rel=stylesheet href=/css/syntax.min.c70103877c799b924f50023b6b01eca010d7e2808885a74f9ea662cc47379ae1.css integrity="sha256-xwEDh3x5m5JPUAI7awHsoBDX4oCIhadPnqZizEc3muE=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.c4814ac9dc5fab259f313a787ded4f8e.css integrity="md5-xIFKydxfqyWfMTp4fe1Pjg==" crossorigin=anonymous><style type=text/css>.main p{text-indent:2em}.main li p{text-indent:0}</style><noscript><style>img.lazyload{display:none}</style></noscript></head><body><div class=sticky-top><div class=header-bar></div><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/cn aria-label=GoHalo>GoHalo</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>项目</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a class=dropdown-item href=/cn/project/bastion/>Bastion</a></li><li><a class="dropdown-item disabled" href=/cn/project/bootserver/>BootServer</a></li></ul></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/>博客</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/archives/>归档</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/tags/>标签</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/slide/>幻灯片</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/docs/>文档</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn dropdown-toggle" id=header-languages data-bs-toggle=dropdown aria-expanded=false data-bs-display=static>
中文</button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=header-languages><li><a class=dropdown-item rel=alternate href=https://gohalo.github.io/en hreflang=en lang=en>English</a></li></ul></div><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=/cn/about><i class="fa fa-user" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/gohalo title=GitHub><i class="fa fa-github-alt" aria-hidden=true></i></a></li><li class=nav-item><button id=mode class="btn nav-link social-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><i class="fa fa-star" aria-hidden=true></i></span>
<span class=toggle-light><i class="fa fa-cog" aria-hidden=true></i></span></button></li></ul></div></div></nav></div><div class="main container-xxl" role=document><div class="blog row"><div class="col-md-12 col-xl-9 mt-4"><div class=header><h1>P2P 协议简介</h1><div class="meta mb-3"><i class="fa fa-calendar" aria-hidden=true></i>
<span class=mx-2>2017-08-28</span>
<i class="fa fa-tags" aria-hidden=true></i>
<a class=text-body href=https://gohalo.github.io/cn/tags/linux/ role=button>linux</a>
<a class=text-body href=https://gohalo.github.io/cn/tags/language/ role=button>language</a></div></div><hr><div class=content><p>不同于传统的 C/S 服务模型，取消了中心服务器，每个节点都可以作为客户端和服务端。</p><a class=anchor id=简介></a><h1>简介 <a href=#%e7%ae%80%e4%bb%8b aria-hidden=true>#</a></h1><p>BitTorrent 实际上是一个协议族，其基本协议是 <a href=http://www.bittorrent.org/beps/bep_0003.html>BEP-3</a> ，其它的大部分协议都是围绕这个来进行扩展或补充。</p><p>如果要通过 P2P 协议进行下载，必须要包含如下的几个文件：</p><ul><li>种子文件，一般后缀为 <code>.torrent</code> ，本质上是一个由 bencode 编码的文本文件，把资源分成很多虚拟块，并记录每个块的 hash 值，还包括了文件大小、名字、Tracker服务器等信息。</li><li>BT 客户端，也就是专门解析 BT 协议的程序，例如迅雷、电驴等。</li><li>Tracker 服务器，记录着 Peer 和种子相关信息，起着中心调控的作用。</li></ul><p>在下载资源的时候，大致的流程如下：</p><ol><li>客户端解码种子文件，得到 Tracker 服务器的地址和资源信息；</li><li>通过和 Tracker 服务器沟通得到其它已经下载该资源的 Peers 信息；</li><li>再和这些 Peers 沟通得到自己想要的部分。</li></ol><p>可以看到，在上述的流程中，Tracker 是整个流程的关键部分，如果不能通过 Tracker 读取到 Peers 的相关信息，那么也就无法下载资源。</p><a class=anchor id=dht-协议></a><h2>DHT 协议 <a href=#dht-%e5%8d%8f%e8%ae%ae aria-hidden=true>#</a></h2><p>为了弥补 Tracker 的单点问题，于是出现了 Distributed Hash Table, DHT 协议，该协议基于 <a href=http://www.ic.unicamp.br/~bit/ensino/mo809_1s13/papers/P2P/Kademlia-%20A%20Peer-to-Peer%20Information%20System%20Based%20on%20the%20XOR%20Metric%20.pdf>Kademlia</a> 建立。</p><a class=anchor id=参考></a><h1>参考 <a href=#%e5%8f%82%e8%80%83 aria-hidden=true>#</a></h1><ul><li>一个资源嗅探器的网站 <a href=http://bthub.io/>bthub.io</a> 。</li><li>官方网站 <a href=http://bittorrent.org/>bittorrent.org</a> 包括了很多相关协议的开发文档。</li><li>一个传输可视化的示例网站 <a href=http://mg8.org/processing/bt.html>mq8.org</a> 。</li></ul></div></div><div class="sidebar col-xl-3 mt-2"><div id=toc class=position-fixed><nav id=TableOfContents><ul><li><a href=#简介>简介</a><ul><li><a href=#dht-协议>DHT 协议</a></li></ul></li><li><a href=#参考>参考</a></li></ul></nav></div></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class=text-center>Built by GoHalo, generated with <a class=text-muted href=https://gohugo.io>Hugo</a>, and hosted on GitHub Pages</div></div><div class=row><div class=text-center>Copyright © 2013-2025 GoHalo. All Rights Reserved.</div></div></div></footer><script src=https://gohalo.github.io/bootstrap/js/bootstrap.bundle.min.js></script>
<script src=/main.b9cbcb174709877512d64e24f297f66a40c8d91c9a81128cb04bdd7b10247df8.js integrity="sha256-ucvLF0cJh3US1k4k8pf2akDI2RyagRKMsEvdexAkffg=" crossorigin=anonymous></script>
<a href=# class="btn btn-light btn-lg backtop" title=返回顶部><i class="fa fa-angle-double-up" aria-hidden=true></i></a></body></html>