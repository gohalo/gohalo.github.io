<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>DNS 的基本概念详解 | GoHalo</title><link rel=apple-touch-icon sizes=180x180 href=https://gohalo.github.io/favicon/apple-touch-icon.png><link rel=icon href=https://gohalo.github.io/favicon/favicon.ico sizes=any><link rel=icon type=image/png sizes=32x32 href=https://gohalo.github.io/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://gohalo.github.io/favicon/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://gohalo.github.io/favicon/site.webmanifest><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=google-site-verification content="p7jJ5d3kF9yxRhpIo5GgHXAZ1ATKVyZhV2kf6mEGOv0"><meta name=description content="在通过浏览器访问某个网站时，或者说访问网络上的服务器时，可以直接使用 IP 地址，但是对于人类来说很难记忆，为此引入了域名，而为了可以做到自动解析，于时就有了 DNS 。
这里详细介绍 DNS 的基本概念。
"><link rel=stylesheet href=https://gohalo.github.io/font-awesome/css/font-awesome.min.css><link rel=stylesheet href=/css/syntax.min.c70103877c799b924f50023b6b01eca010d7e2808885a74f9ea662cc47379ae1.css integrity="sha256-xwEDh3x5m5JPUAI7awHsoBDX4oCIhadPnqZizEc3muE=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.c4814ac9dc5fab259f313a787ded4f8e.css integrity="md5-xIFKydxfqyWfMTp4fe1Pjg==" crossorigin=anonymous><style type=text/css>.main p{text-indent:2em}.main li p{text-indent:0}</style><noscript><style>img.lazyload{display:none}</style></noscript></head><body><div class=sticky-top><div class=header-bar></div><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/cn aria-label=GoHalo>GoHalo</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>项目</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a class=dropdown-item href=/cn/project/bastion/>Bastion</a></li><li><a class="dropdown-item disabled" href=/cn/project/bootserver/>BootServer</a></li></ul></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/>博客</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/archives/>归档</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/tags/>标签</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/slide/>幻灯片</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/docs/>文档</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn dropdown-toggle" id=header-languages data-bs-toggle=dropdown aria-expanded=false data-bs-display=static>
中文</button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=header-languages><li><a class=dropdown-item rel=alternate href=https://gohalo.github.io/en hreflang=en lang=en>English</a></li></ul></div><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=/cn/about><i class="fa fa-user" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/gohalo title=GitHub><i class="fa fa-github-alt" aria-hidden=true></i></a></li><li class=nav-item><button id=mode class="btn nav-link social-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><i class="fa fa-star" aria-hidden=true></i></span>
<span class=toggle-light><i class="fa fa-cog" aria-hidden=true></i></span></button></li></ul></div></div></nav></div><div class="main container-xxl" role=document><div class="blog row"><div class="col-md-12 col-xl-9 mt-4"><div class=header><h1>DNS 的基本概念详解</h1><div class="meta mb-3"><i class="fa fa-calendar" aria-hidden=true></i>
<span class=mx-2>2015-03-19</span>
<i class="fa fa-tags" aria-hidden=true></i>
<a class=text-body href=https://gohalo.github.io/cn/tags/linux/ role=button>linux</a>
<a class=text-body href=https://gohalo.github.io/cn/tags/network/ role=button>network</a></div></div><hr><div class=content><p>在通过浏览器访问某个网站时，或者说访问网络上的服务器时，可以直接使用 IP 地址，但是对于人类来说很难记忆，为此引入了域名，而为了可以做到自动解析，于时就有了 DNS 。</p><p>这里详细介绍 DNS 的基本概念。</p><a class=anchor id=简介></a><h1>简介 <a href=#%e7%ae%80%e4%bb%8b aria-hidden=true>#</a></h1><p>域名最初是通过手动配置的，在 Linux 中就是通过 <code>/etc/hosts</code> 文件进行配置，但是这种方法的缺陷是无法自动更新，尤其是当有大量服务器需要配置时，为了解决这一问题，于是就有了 DNS 。</p><p>最早是伯克利开发了一套分层的管理系统，称为 <code>Berkeley Internet Name Domain, BIND</code>，后来就是全世界使用最广泛的域名系统 <code>Domain Name System, DNS</code>。</p><p>首先介绍下常用的概念。</p><a class=anchor id=常用概念></a><h2>常用概念 <a href=#%e5%b8%b8%e7%94%a8%e6%a6%82%e5%bf%b5 aria-hidden=true>#</a></h2><p><code>Fully Qualified Domain Name, FQDN</code> 全限定域名包括了主机名 <code>Hostname</code> 和域名 <code>Domain Name</code>，通过符号 <code>.</code> 进行分割，主机名和域名是相对而言，如下图所示，不同的层级，主机名和域名也不同。</p><p>例如，假设提供 Web 服务的主机名为 <code>www</code> 而域名为 <code>foobar.com</code> ，那么对应的 FQDN 就是 <code>www.foobar.com</code> ，也就是我们最常见的地址。</p><p>当然，所谓的主机名并非只是一台主机。</p><p><img alt="dns examples" src=images/dns-host-domain-name.gif class="mx-auto d-block"></p><p>需要注意的是，并不是以小数点 <code>.</code> 区分主机名和域名，主机名可以为 <code>www.dic</code> ，而域名还是 <code>ksu.edu.tw</code> ，因此此时全名就为 <code>www.dic.ksu.edu.tw</code> 。</p><a class=anchor id=dns-的阶层架构与-tld></a><h2>DNS 的阶层架构与 TLD <a href=#dns-%e7%9a%84%e9%98%b6%e5%b1%82%e6%9e%b6%e6%9e%84%e4%b8%8e-tld aria-hidden=true>#</a></h2><p>仍以 <code>ksu.edu.tw</code> 域名为例，如下图所示。</p><p><img alt="dns examples" src=images/dns-dot-gtld-cctld.gif class="mx-auto d-block"></p><p>在整个 DNS 系统的最上方一定是根服务器，管理了最上层的域名 (<code>Generic TLDs, gTLD</code> 如 <code>.com</code> <code>.org</code> <code>.gov</code> 等等) 以及国家最上层领域名 (<code>Country code TLDs, ccTLD</code> 如 <code>.tw</code> <code>.uk</code> <code>.jp</code> <code>.cn</code> 等) ，这两者称为 <code>Top Level Domains, TLDs</code> 。</p><p>每一层需要向上层 ISP 申请，如 <code>.tw</code>，管理这个领域名的机器 IP 是在台湾，但是 <code>.tw</code> 这部服务器必须向 root <code>.</code> 注册领域名查询授权才行。各层 DNS 都能管理自己辖下的主机名或子领域，因此，<code>.tw</code> 可以自行规划自己的子域名。</p><p>每层 DNS 服务器所记录的信息，其实只有其下层的主机名而已；至于再下一层，则直接授权给下层的主机来管理。</p><a class=anchor id=顶层服务器></a><h2>顶层服务器 <a href=#%e9%a1%b6%e5%b1%82%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-hidden=true>#</a></h2><p>目前，世界上只有 13 个顶级根域名服务器，可以通过 <a href=http://www.internic.net/domain/named.root>www.internic.net</a> 查看。需要注意的是，这里所说 13 个根 DNS 服务器，指的是逻辑上有 13 个，而不是物理上 13 个服务器。</p><p>实际上，目前物理上有几百个根服务器，大部分通过任播技术与逻辑服务器对应，当前的根服务器可以通过 <a href=http://www.root-servers.org/>www.root-servers.org</a> 查看，那么，为什么全球 DNS 根服务器只有 13 组。</p><p>DNS 协议最初从 20 世纪 80 年代未期开始算起，使用了端口上的 UDP 和 TCP 协议；UDP 用于查询和响应，TCP 用于主从服务器之间的区传送。</p><p>在 Internet 数据传输中，UDP 数据长度控制在 576 字节 (Internet 标准 MTU 值)，而在许多 UDP 应用程序设计中数据包被限制成 512 字节或更小，这样可以防止数据包的丢失。</p><p>而 512 字节对于在每个包中必须含有数字签名的一些 DNS 新特性（如DNSSEC）来说实在是太小了。如果要让所有的根服务器数据能包含在一个 512 字节的 UDP 包中，根服务器只能限制在 13 个，而每个服务器要使用字母表中的单个字母命名。</p><p>注意，大部分的客户端会先通过 UDP 查询，如果发现被截断，那么会重新使用 TCP 再次查询，这样就可以绕过 512 字节的限制，但是会降低查询效率。</p><a class=anchor id=解析过程详解></a><h1>解析过程详解 <a href=#%e8%a7%a3%e6%9e%90%e8%bf%87%e7%a8%8b%e8%af%a6%e8%a7%a3 aria-hidden=true>#</a></h1><p>接下来详细查看下 DNS 解析的具体执行过程。</p><a class=anchor id=1-查询-dns-服务器-ip></a><h4>1. 查询 DNS 服务器 IP <a href=#1-%e6%9f%a5%e8%af%a2-dns-%e6%9c%8d%e5%8a%a1%e5%99%a8-ip aria-hidden=true>#</a></h4><p>我们的电脑通过 ISP 接入互联网，ISP 会分配一个 DNS 服务器，这个 DNS 服务器不是权威服务器，而是一个代理 DNS 服务器，用来代理查询 IP，可以查看 <code>/etc/resolv.conf</code> 文件。</p><p>注意，老的 Linux 发行版本，该文件是手动编辑的，现在很多 (如 CentOS) 是自动生成的，详见 <a href=/cn/blog/network-dns-resolv-conf-usage-introduce/>resolv.conf 简介</a>。</p><a class=anchor id=2-发起请求></a><h4>2. 发起请求 <a href=#2-%e5%8f%91%e8%b5%b7%e8%af%b7%e6%b1%82 aria-hidden=true>#</a></h4><p>向上述的 DNS 服务发起请求查询 <code>www.baidu.com</code> 这个域名了，当然详细信息可以通过 <code>dig +trace www.baidu.com</code> 查看，不过在国内的环境经常出错，那我们就一步一步来查看。</p><a class=anchor id=3-如果有缓存直接返回></a><h4>3. 如果有缓存直接返回 <a href=#3-%e5%a6%82%e6%9e%9c%e6%9c%89%e7%bc%93%e5%ad%98%e7%9b%b4%e6%8e%a5%e8%bf%94%e5%9b%9e aria-hidden=true>#</a></h4><p>上述服务器收到请求后，如果自己缓存中有这个地址，则直接返回，且标记为非权威服务器应答。</p><a class=anchor id=4-没有命中则从根开始查询></a><h4>4. 没有命中，则从根开始查询 <a href=#4-%e6%b2%a1%e6%9c%89%e5%91%bd%e4%b8%ad%e5%88%99%e4%bb%8e%e6%a0%b9%e5%bc%80%e5%a7%8b%e6%9f%a5%e8%af%a2 aria-hidden=true>#</a></h4><p>如果缓存中没有，则会开始查询 13 个<a href=https://www.internic.net/domain/named.root>根域名服务器的地址</a>，这些地址是不变的，可以直接保存在 BIND 的配置文件中。</p><p>可以直接通过如下方式查询。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ dig @a.root-servers.net root-servers.net ns
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      h.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      i.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      k.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      b.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      j.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      g.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      e.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      l.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      m.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      c.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      d.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      f.ROOT-SERVERS.NET.
</span></span><span class=line><span class=cl>ROOT-SERVERS.NET.       141973  IN      NS      a.ROOT-SERVERS.NET.
</span></span></code></pre></div><a class=anchor id=5-向其中一台根服务器发起请求></a><h4>5. 向其中一台根服务器发起请求 <a href=#5-%e5%90%91%e5%85%b6%e4%b8%ad%e4%b8%80%e5%8f%b0%e6%a0%b9%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%8f%91%e8%b5%b7%e8%af%b7%e6%b1%82 aria-hidden=true>#</a></h4><p>根服务器拿到这个请求后，知道他是 <code>com.</code> 这个顶级域名下的，所以就会返回 <code>com</code> 域中的 NS 记录，通常是 13 台主机名和 IP 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ dig com. ns                # 同下
</span></span><span class=line><span class=cl>$ dig @a.root-servers.net com ns
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      i.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      m.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      l.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      j.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      b.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      a.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      k.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      h.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      c.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      d.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      g.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      f.gtld-servers.net.
</span></span><span class=line><span class=cl>com.                    17051   IN      NS      e.gtld-servers.net.
</span></span></code></pre></div><a class=anchor id=6-向顶级域名服务器发送请求></a><h4>6. 向顶级域名服务器发送请求 <a href=#6-%e5%90%91%e9%a1%b6%e7%ba%a7%e5%9f%9f%e5%90%8d%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%8f%91%e9%80%81%e8%af%b7%e6%b1%82 aria-hidden=true>#</a></h4><p>同样是向其中一台发起请求，请求 <code>baidu.com</code> 这个域的域名服务器。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ dig @e.gtld-servers.net baidu.com ns
</span></span><span class=line><span class=cl>baidu.com.              9141    IN      NS      dns.baidu.com.
</span></span><span class=line><span class=cl>baidu.com.              9141    IN      NS      ns7.baidu.com.
</span></span><span class=line><span class=cl>baidu.com.              9141    IN      NS      ns2.baidu.com.
</span></span><span class=line><span class=cl>baidu.com.              9141    IN      NS      ns3.baidu.com.
</span></span><span class=line><span class=cl>baidu.com.              9141    IN      NS      ns4.baidu.com.
</span></span></code></pre></div><a class=anchor id=7-再次发送请求></a><h4>7. 再次发送请求 <a href=#7-%e5%86%8d%e6%ac%a1%e5%8f%91%e9%80%81%e8%af%b7%e6%b1%82 aria-hidden=true>#</a></h4><p>再次向 <code>baidu.com</code> 这个域的权威服务器发起请求，<code>baidu.com</code> 收到之后，查了下有 <code>www</code> 的这台主机，就把这个 IP 返回给你了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ dig @dns.baidu.com www.baidu.com
</span></span><span class=line><span class=cl>www.baidu.com.          547     IN      CNAME   www.a.shifen.com.
</span></span><span class=line><span class=cl>www.a.shifen.com.       144     IN      A       220.181.111.188
</span></span><span class=line><span class=cl>www.a.shifen.com.       144     IN      A       220.181.112.244
</span></span></code></pre></div><a class=anchor id=8-返回给客户></a><h4>8. 返回给客户 <a href=#8-%e8%bf%94%e5%9b%9e%e7%bb%99%e5%ae%a2%e6%88%b7 aria-hidden=true>#</a></h4><p>拿到了 IP 之后将其返回给了客户端，并且把这个保存在高速缓存中。</p><a class=anchor id=服务器分类></a><h1>服务器分类 <a href=#%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%88%86%e7%b1%bb aria-hidden=true>#</a></h1><p>在如上介绍解析流程的时候，会有关于所谓权威服务器的介绍，这里介绍常见概念。</p><a class=anchor id=权威-dns></a><h2>权威 DNS <a href=#%e6%9d%83%e5%a8%81-dns aria-hidden=true>#</a></h2><p>权威 DNS 是经过上一级授权对域名进行解析的服务器，每个域都会有域名服务器，也叫权威域名服务器，例如 <code>baidu.com</code> 是一个域名，而 <code>www.baidu.com</code> 主机就是这个域管理的主机。</p><a class=anchor id=递归-dns></a><h2>递归 DNS <a href=#%e9%80%92%e5%bd%92-dns aria-hidden=true>#</a></h2><p>会接受用户对任意域名查询，并返回结果给用户，一般会缓存查询结果以避免重复向上查询。</p><p>平时使用最多的就是这类 DNS 服务器，会对公众开放服务，一般由网络运营商或者互联网厂商提供，比如谷歌的 <code>8.8.8.8</code> 就属于这一类 DNS 。</p><a class=anchor id=转发-dns></a><h2>转发 DNS <a href=#%e8%bd%ac%e5%8f%91-dns aria-hidden=true>#</a></h2><p>同样负责接受用户查询，并返回结果给用户，这个结果不是按标准的域名解析过程得到的，而是直接把递归 DNS 的结果转发给用户，同样具备缓存功能。</p><p>比如路由器里面的 DNS 就是这一类。</p><a class=anchor id=记录类型></a><h1>记录类型 <a href=#%e8%ae%b0%e5%bd%95%e7%b1%bb%e5%9e%8b aria-hidden=true>#</a></h1><p>在 DNS 中最常见的是 Internet 资源，包括了 4 个元组：<code>Name</code>、<code>Value</code>、<code>Type</code>、<code>TTL</code>。其中 <code>TTL</code> 表示生存时间，决定了多长时间会从缓存中删除；<code>Type</code> 决定了 <code>Name</code> 和 <code>Value</code>，常见有如下几种：</p><ul><li>A 记录，Address。用于描述域名到 IP 地址的映射，同一个域名可以对应多个记录，也就是一次 DNS 查询可以返回多个 IP，从而可以实现基本的流量均衡。</li><li>NS 记录，Name Server。域名服务器记录，用于说明这个区域有那些 DNS 服务器来负责解析，每个域可以有多个域名服务器。</li><li>SOA 记录，Start Of Authority。用于指定该域的权威域名服务器，负责说明负责解析的 DNS 服务器中那个是主服务器，只允许有一个 SOA 记录，它是资源记录的第一个条目。</li><li>CNAME 记录。描述别名和域名的关系，从而可以允许将多个名字映射到同一台服务器。例如，一台服务器同时提供 WWW 和 MAIL 服务，可以提供两个 www.foobar.com mail.foobar.com 别名同时指向 host.foobar.com 。</li><li>MX 记录。全称是邮件交换记录，在使用邮件服务器的时候，MX 记录是无可或缺。比如 A 用户向 B 用户发送一封邮件，那么他需要向 DNS 查询 Ｂ 的 MX 记录。</li></ul><a class=anchor id=faq></a><h1>FAQ <a href=#faq aria-hidden=true>#</a></h1><a class=anchor id=根域></a><h4>根域 <a href=#%e6%a0%b9%e5%9f%9f aria-hidden=true>#</a></h4><p>其实就是所谓的 <code>.</code> 或者根域，是指网址 <code>www.baidu.com</code> 在配置中应该是 <code>www.baidu.com.</code> 只是一般在浏览器输入时会省略后面的点。</p><a class=anchor id=a-记录与-cname-记录的区别></a><h4>A 记录与 CNAME 记录的区别？ <a href=#a-%e8%ae%b0%e5%bd%95%e4%b8%8e-cname-%e8%ae%b0%e5%bd%95%e7%9a%84%e5%8c%ba%e5%88%ab aria-hidden=true>#</a></h4><p>A 记录是把一个域名解析到一个 IP 地址，而 CNAME 记录是把域名解析到另外一个域名，而这个域名最终会指向一个 A 记录。</p><p>当一台机器提供了多个服务时，这种方式比较容易修改。将多个域名映射到一个相同域名，然后只需要修改被映射的域名即可。</p><a class=anchor id=cname-的使用></a><h4>CNAME 的使用 <a href=#cname-%e7%9a%84%e4%bd%bf%e7%94%a8 aria-hidden=true>#</a></h4><p>比较常见的一个是 Github 提供的项目 Pages 的支持，一般是类似 <code>PROJECT.github.io</code> 的域名，实际上指向的是一个 CNAME 配置，最终为同一个域名。</p><p>根据解析之后的 A 地址，对应的 Web 服务器就可以进行解析处理了。因为基本上就是个静态页面，所以很容易做一些缓存的策略。</p><a class=anchor id=ptr-用途></a><h4>PTR 用途 <a href=#ptr-%e7%94%a8%e9%80%94 aria-hidden=true>#</a></h4><p>PTR 用于从 IP 地址反查域名，可以使用 <code>dit -x IP</code> 进行反查。</p><p>其中的一个场景是防止垃圾邮件，即验证发送邮件的 IP 地址，是否真的有它所声称的域名。</p><a class=anchor id=ttl-值></a><h4>TTL 值 <a href=#ttl-%e5%80%bc aria-hidden=true>#</a></h4><p>Time To Live, TTL 生存时间，表示解析记录在 DNS 服务器中的缓存时间，默认是 3600 秒。</p><p>例如在访问 <code>www.foobar.com</code> 时，如果在 DNS 服务器的缓存中没有该记录，就会向 NS 服务器发出请求，获得该记录后，该记录会在 DNS 服务器上缓存 TTL 的时间长度，在 TTL 有效期内访问 <code>www.foobar.com</code> 时，会直接返回。</p><a class=anchor id=dns-服务器地址></a><h4>DNS 服务器地址 <a href=#dns-%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%9c%b0%e5%9d%80 aria-hidden=true>#</a></h4><p>通过 <code>dig</code> 命令查询时，默认会依次查询 <code>/etc/resolv.conf</code> 文件中的地址，至于是从哪个 DNS 服务器地址查询到，可以查看返回结果中的 <code>SERVER</code> 字段，例如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>;; Query time: 1 msec
</span></span><span class=line><span class=cl>;; SERVER: 10.0.52.180#53(10.0.52.180)
</span></span><span class=line><span class=cl>;; WHEN: Thu May 09 15:38:04 CST 2017
</span></span><span class=line><span class=cl>;; MSG SIZE  rcvd: 101
</span></span></code></pre></div><p>当然，可以在执行时通过 <code>@</code> 指定，例如如下的方式。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ dig @8.8.8.8 www.baidu.com
</span></span></code></pre></div><a class=anchor id=参考></a><h1>参考 <a href=#%e5%8f%82%e8%80%83 aria-hidden=true>#</a></h1><ul><li>与 DNS 协议的相关 RFC 文档有，RFC1034-(DOMAIN NAMES - CONCEPTS AND FACILITIES)、RFC1035-(DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION)。</li><li>关于 DNS 介绍可以参考 <a href=http://vbird.dic.ksu.edu.tw/linux_server/0350dns.php>鸟哥的私房菜 - DNS 服务器</a>，或者 <a href=http://www.tldp.org/HOWTO/DNS-HOWTO.html>DNS HowTo</a>，一个简单的搭建 BIND 服务器的介绍，或者参考 <a href=https://www.madboa.com/geek/soho-bind/>BIND for the Small LAN</a> 。</li><li>关于 dig 命令的帮助可以查看 <a href=https://www.madboa.com/geek/dig/>DiG HOWTO</a>，其中包括了一个用于检测本地 DNS 配置是否正确的脚本。</li><li>其他的一些常见工具包括 <a href=http://tool.alikunlun.com/doc.html>阿里昆仑用户诊断工具</a>、<a href=http://utp.qq.com/>腾讯华佗诊断工具</a>；<a href=http://www.alidns.com/>阿里公共DNS解析服务</a>，及其帮助文档 <a href=http://www.alidns.com/faqs/>FAQs</a>，其他公共 DNS 解析服务还有 114；<a href=http://www.root-servers.org/>根服务器分布</a>；<a href=http://ip.taobao.com>淘宝IP地址库</a> 。</li></ul></div></div><div class="sidebar col-xl-3 mt-2"><div id=toc class=position-fixed><nav id=TableOfContents><ul><li><a href=#简介>简介</a><ul><li><a href=#常用概念>常用概念</a></li><li><a href=#dns-的阶层架构与-tld>DNS 的阶层架构与 TLD</a></li><li><a href=#顶层服务器>顶层服务器</a></li></ul></li><li><a href=#解析过程详解>解析过程详解</a><ul><li></li></ul></li><li><a href=#服务器分类>服务器分类</a><ul><li><a href=#权威-dns>权威 DNS</a></li><li><a href=#递归-dns>递归 DNS</a></li><li><a href=#转发-dns>转发 DNS</a></li></ul></li><li><a href=#记录类型>记录类型</a></li><li><a href=#faq>FAQ</a><ul><li></li></ul></li><li><a href=#参考>参考</a></li></ul></nav></div></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class=text-center>Built by GoHalo, generated with <a class=text-muted href=https://gohugo.io>Hugo</a>, and hosted on GitHub Pages</div></div><div class=row><div class=text-center>Copyright © 2013-2025 GoHalo. All Rights Reserved.</div></div></div></footer><script src=https://gohalo.github.io/bootstrap/js/bootstrap.bundle.min.js></script>
<script src=/main.b9cbcb174709877512d64e24f297f66a40c8d91c9a81128cb04bdd7b10247df8.js integrity="sha256-ucvLF0cJh3US1k4k8pf2akDI2RyagRKMsEvdexAkffg=" crossorigin=anonymous></script>
<a href=# class="btn btn-light btn-lg backtop" title=返回顶部><i class="fa fa-angle-double-up" aria-hidden=true></i></a></body></html>