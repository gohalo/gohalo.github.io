<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>MySQL 使用简介 | GoHalo</title><link rel=apple-touch-icon sizes=180x180 href=https://gohalo.github.io/favicon/apple-touch-icon.png><link rel=icon href=https://gohalo.github.io/favicon/favicon.ico sizes=any><link rel=icon type=image/png sizes=32x32 href=https://gohalo.github.io/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://gohalo.github.io/favicon/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://gohalo.github.io/favicon/site.webmanifest><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=google-site-verification content="p7jJ5d3kF9yxRhpIo5GgHXAZ1ATKVyZhV2kf6mEGOv0"><meta name=description content="MySQL 是一款最流行的开源关系型数据库，最初由瑞典的 MySQL AB 公司开发，目前已被 Oracle 收购，现在比较流行的分支包括了 MariaDB 和 Percona。
现在来看，MySQL 被收购之后，实际上添加了很多不错的特性，解掉了很多之前未解的问题，而现在 MariaDB 离主干的特性越来越远；而 Percona 据说为了保证质量是不接受社区提供的代码的，不过其提供的工具却是极好的^_^
在此，简单介绍，二进制安装、源码编译安装、单实例以及多实例的启动、常见的调试方法。
"><link rel=stylesheet href=https://gohalo.github.io/font-awesome/css/font-awesome.min.css><link rel=stylesheet href=/css/syntax.min.c70103877c799b924f50023b6b01eca010d7e2808885a74f9ea662cc47379ae1.css integrity="sha256-xwEDh3x5m5JPUAI7awHsoBDX4oCIhadPnqZizEc3muE=" crossorigin=anonymous><link rel=stylesheet href=/css/main.min.c4814ac9dc5fab259f313a787ded4f8e.css integrity="md5-xIFKydxfqyWfMTp4fe1Pjg==" crossorigin=anonymous><style type=text/css>.main p{text-indent:2em}.main li p{text-indent:0}</style><noscript><style>img.lazyload{display:none}</style></noscript></head><body><div class=sticky-top><div class=header-bar></div><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/cn aria-label=GoHalo>GoHalo</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-expanded=false>项目</a><ul class=dropdown-menu aria-labelledby=navbarDropdown><li><a class=dropdown-item href=/cn/project/bastion/>Bastion</a></li><li><a class="dropdown-item disabled" href=/cn/project/bootserver/>BootServer</a></li></ul></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/>博客</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/archives/>归档</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/blog/tags/>标签</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/slide/>幻灯片</a></li><li class=nav-item><a class=nav-link aria-current=page href=/cn/docs/>文档</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn dropdown-toggle" id=header-languages data-bs-toggle=dropdown aria-expanded=false data-bs-display=static>
中文</button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=header-languages><li><a class=dropdown-item rel=alternate href=https://gohalo.github.io/en hreflang=en lang=en>English</a></li></ul></div><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=/cn/about><i class="fa fa-user" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/gohalo title=GitHub><i class="fa fa-github-alt" aria-hidden=true></i></a></li><li class=nav-item><button id=mode class="btn nav-link social-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><i class="fa fa-star" aria-hidden=true></i></span>
<span class=toggle-light><i class="fa fa-cog" aria-hidden=true></i></span></button></li></ul></div></div></nav></div><div class="main container-xxl" role=document><div class="blog row"><div class="col-md-12 col-xl-9 mt-4"><div class=header><h1>MySQL 使用简介</h1><div class="meta mb-3"><i class="fa fa-calendar" aria-hidden=true></i>
<span class=mx-2>2017-07-16</span>
<i class="fa fa-tags" aria-hidden=true></i>
<a class=text-body href=https://gohalo.github.io/cn/tags/database/ role=button>database</a>
<a class=text-body href=https://gohalo.github.io/cn/tags/mysql/ role=button>mysql</a></div></div><hr><div class=content><p>MySQL 是一款最流行的开源关系型数据库，最初由瑞典的 MySQL AB 公司开发，目前已被 Oracle 收购，现在比较流行的分支包括了 MariaDB 和 Percona。</p><p>现在来看，MySQL 被收购之后，实际上添加了很多不错的特性，解掉了很多之前未解的问题，而现在 MariaDB 离主干的特性越来越远；而 Percona 据说为了保证质量是不接受社区提供的代码的，不过其提供的工具却是极好的^_^</p><p>在此，简单介绍，二进制安装、源码编译安装、单实例以及多实例的启动、常见的调试方法。</p><img src=images/mysql-intro-logo.jpg alt="mysql introduce logo" width=30%>
<a class=anchor id=安装></a><h1>安装 <a href=#%e5%ae%89%e8%a3%85 aria-hidden=true>#</a></h1><p>对于 Ubuntu、CentOS 这样的发行版本可以直接通过命令行安装，从 CentOS 7 之后，实际安装的是 MariaDB ，也可以通过 Oracle 提供的官方 YUM repository ，然后安装 MySQL Community Server，下面以 CentOS 为例。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># yum install -y mariadb-server mariadb                                      ← 安装MariaDB
</span></span><span class=line><span class=cl># systemctl start mariadb                                                    ← 启动server
</span></span><span class=line><span class=cl># systemctl enable mysqld                                                    ← 设置开机启动
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># rpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm ← 安装仓库
</span></span><span class=line><span class=cl># yum install mysql-community-server                                         ← 安裝社区版
</span></span><span class=line><span class=cl># cat &lt;&lt; EOF &gt; /etc/my.cnf                                                   ← 设置配置文件
</span></span><span class=line><span class=cl>[client]
</span></span><span class=line><span class=cl>password        = new_password
</span></span><span class=line><span class=cl>port            = 5506
</span></span><span class=line><span class=cl>socket          = /tmp/mysql-5506.sock
</span></span><span class=line><span class=cl>[mysqld]
</span></span><span class=line><span class=cl>user            = mysql
</span></span><span class=line><span class=cl>port            = 5506
</span></span><span class=line><span class=cl>socket          = /tmp/mysql-5506.sock
</span></span><span class=line><span class=cl>basedir         = /usr
</span></span><span class=line><span class=cl>datadir         = /home/foobar/databases/data-5506
</span></span><span class=line><span class=cl>pid-file        = /home/foobar/databases/data-5506/mysqld.pid
</span></span><span class=line><span class=cl>EOF
</span></span><span class=line><span class=cl># /usr/sbin/mysqld --initialize-insecure --basedir=/usr --user=mysql \       ← 初始化数据，可通过空白密码登陆
</span></span><span class=line><span class=cl>    --datadir=/home/foobar/databases/data-5506
</span></span><span class=line><span class=cl># systemctl start mysqld                                                     ← 启动server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ mysql -h 127.1                                                             ← 直接登陆
</span></span><span class=line><span class=cl>mysql&gt; ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;new_password&#39;;           ← 修改密码
</span></span><span class=line><span class=cl>mysql&gt; FLUSH PRIVILEGES;
</span></span></code></pre></div><p>通过 RPM 包安装时，默认是保存到 <code>/var/lib/mysql</code> 目录下。另外，需要注意，需要保证上级目录权限为 755，否则可能会报 Permission denied 错误。</p><p>当然也可以从 <a href=http://dev.mysql.com/downloads/>MySQL 官网</a>、<a href=https://downloads.mariadb.org/>MariaDB 官网</a> 或者 <a href=https://www.percona.com/>Percona 官网</a> 下载相应的安装包，或者源码。对于 CentOS 7 来说，可以从 <a href=https://dev.mysql.com/downloads/>MySQL Community Downloads</a> 下载 server、client、common、libs 对应的 RPM 包，也可从 <a href=http://mirrors.sohu.com/mysql/>sohu 镜像</a> 下载，然后安装即可。</p><a class=anchor id=密码配置></a><h2>密码配置 <a href=#%e5%af%86%e7%a0%81%e9%85%8d%e7%bd%ae aria-hidden=true>#</a></h2><p>如果没有手动初始化数据直接启动，那么会将 root 密码打印到日志中，然后可以直接登陆；也可以修改配置文件跳过认证，也就是添加 <code>skip-grant-tables</code> 选项。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>----- 不建议使用如下方式修改密码
</span></span><span class=line><span class=cl>mysql&gt; SET PASSWORD=PASSWORD(&#39;Root1234@&#39;);
</span></span><span class=line><span class=cl>mysql&gt; FLUSH PRIVILEGES;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 可以使用如下方式修改，且不需要FLUSH，建议时候后者
</span></span><span class=line><span class=cl>mysql&gt; SET password=&#39;Root1234@&#39;;
</span></span><span class=line><span class=cl>mysql&gt; ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;Your@123NewPassword&#39;;
</span></span></code></pre></div><p>在 8.X 版本之后会初始化一个默认的密码，可以通过 <code>grep 'temporary password' /var/log/mysqld.log</code> 命令查看，或者第一次启动 mysqld 服务时添加 <code>--initialize-insecure</code> 参数无密码登录。</p><p>登录后需要修改密码，否则执行其它 SQL 会报错，注意，对密码的复杂度是有要求的。</p><a class=anchor id=编译安装></a><h2>编译安装 <a href=#%e7%bc%96%e8%af%91%e5%ae%89%e8%a3%85 aria-hidden=true>#</a></h2><p>还是直接从官网下载源码即可，假设直接解压到 <code>/home/foobar/Workspace/mysql</code> 并将安装目录设置为 <code>/opt/mysql-5.7</code> 。</p><p>下面介绍如何通过源码进行安装，最简单的是通过 <code>BUILD/compile-ARCH</code> 脚本进行编译，当然，可以选择使用 autotools 或者 CMake 指定相应的参数进行安装，在此通过 CMake 安装。</p><p>通过 CMake 编译时，有两种编译方式：A) 内部编译，即在源码内部编译，此时会有一些编译产生的临时文件，影响代码结构；B) 外部编译，不会影响原代码的结构，在此采用外部编译。</p><p>所谓的外部编译，就是在一个新的目录下进行编译，此时编译的中间文件不会影响到源码的目录结构。源码可以直接从官网下载，三个发行版本的源码编译方式都类似，在此以 MySQL 为例。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>----- 安装依赖包，以及相关的开发库
</span></span><span class=line><span class=cl># yum install gcc-c++ g++ ncurses-devel readline-devel zlib-devel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 源码安装
</span></span><span class=line><span class=cl>$ tar -xf mysql-boost-x.x.xx.tar.bz2
</span></span><span class=line><span class=cl>$ cd mysql-boost-x.x.xx &amp;&amp; mkdir build &amp;&amp; cd build       ← 新建编译的目录
</span></span><span class=line><span class=cl>$ cmake ..                                     \
</span></span><span class=line><span class=cl>    -DCMAKE_INSTALL_PREFIX=/opt/mysql-5.7      \         ← 安装根目录
</span></span><span class=line><span class=cl>    -DMYSQL_DATADIR=/opt/data                  \         ← 数据文件的默认路径
</span></span><span class=line><span class=cl>    -DSYSCONFDIR=/etc                          \         ← 配置文件目录，默认/etc/my.cnf
</span></span><span class=line><span class=cl>                                               \
</span></span><span class=line><span class=cl>    -DWITH_INNOBASE_STORAGE_ENGINE=ON          \         ← 使用InnoDB存储引擎
</span></span><span class=line><span class=cl>    -DWITH_BLACKHOLE_STORAGE_ENGINE=ON         \         ← 黑洞存储引擎
</span></span><span class=line><span class=cl>    -DWITH_EXAMPLE_STORAGE_ENGINE=ON           \         ← 使用存储示例
</span></span><span class=line><span class=cl>                                               \
</span></span><span class=line><span class=cl>    -DWITHOUT_FEDERATED_STORAGE_ENGINE=ON      \         ← 取消一些不常用的存储引擎
</span></span><span class=line><span class=cl>    -DWITHOUT_PARTITION_STORAGE_ENGINE=ON      \
</span></span><span class=line><span class=cl>    -DWITHOUT_ARCHIVE_STORAGE_ENGINE=ON        \         ← 日志记录和聚合分析，不支持索引
</span></span><span class=line><span class=cl>                                               \
</span></span><span class=line><span class=cl>    -DMYSQL_TCP_PORT=3306                      \         ← 默认使用的端口号
</span></span><span class=line><span class=cl>    -DMYSQL_UNIX_ADDR=/tmp/mysql.sock          \         ← 默认套接字文件路径
</span></span><span class=line><span class=cl>    -DMYSQL_USER=mysql                         \         ← 默认使用的用户
</span></span><span class=line><span class=cl>                                               \
</span></span><span class=line><span class=cl>    -DEXTRA_CHARSETS=all                       \         ← 是否支持额外的字符集
</span></span><span class=line><span class=cl>    -DDEFAULT_CHARSET=utf8                     \         ← 默认编码机制
</span></span><span class=line><span class=cl>    -DDEFAULT_COLLATION=utf8_general_ci        \         ← 设定默认语言的排序规则
</span></span><span class=line><span class=cl>                                               \
</span></span><span class=line><span class=cl>    -DWITH_READLINE=ON                         \         ← 使用readline库，支持类shell的快捷键以及历史命令
</span></span><span class=line><span class=cl>    -DENABLED_LOCAL_INFILE=ON                  \         ← 支持批量导入
</span></span><span class=line><span class=cl>    -DWITH_LIBWRAP=OFF                         \         ← 是否可以基于WRAP实现访问控制
</span></span><span class=line><span class=cl>    -DWITH_SSL=system                          \         ← 支持ssl会话，实现基于ssl的数据复制
</span></span><span class=line><span class=cl>    -DWITH_ZLIB=system                         \         ← 压缩库
</span></span><span class=line><span class=cl>    -DWITH_EMBEDDED_SERVER=OFF                 \         ← 取消embedded模式
</span></span><span class=line><span class=cl>    -DENABLE_PROFILING=ON                      \         ← 启用性能分析功能
</span></span><span class=line><span class=cl>    -DCMAKE_BUILD_TYPE=Debug                   \         ← 打开调试选项
</span></span><span class=line><span class=cl>    -DWITH_SAFEMALLOC=OFF                      \         ← 关闭safemalloc，经常会报错误，5.7不需要
</span></span><span class=line><span class=cl>    -DWITH_BOOST=../boost                                ← 5.7需要该boost库，直接下载含该库的包
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 编译源码并安装
</span></span><span class=line><span class=cl>$ make -j`cat /proc/cpuinfo | grep &#39;processor&#39; | wc -l`  ← 可以简单使用make并行编译，指定并发
</span></span><span class=line><span class=cl># make install                                           ← 安装
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 设置环境
</span></span><span class=line><span class=cl>$ export PATH=$PATH:/opt/mysql-5.7/bin                   ← 设置环境变量
</span></span><span class=line><span class=cl>$ vi /etc/ld.so.conf &amp;&amp; sudo ldconfig                    ← 设置动态库目录
</span></span><span class=line><span class=cl>$ mysql_config                                           ← 可用于查看环境配置，很多MySQL软件依赖该命令
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 源码安装时最好将build目录中的如下文件保存下
</span></span><span class=line><span class=cl># cat install_manifest.txt | xargs rm                    ← 直接手动删除
</span></span></code></pre></div><p>注意，除了上述列举的选项外，可通过 <code>cmake .. -LH</code> 查看当前版本所支持的选项，如要重新编译可以直接运行 <code>make clean; rm CMakeCache.txt; cmake ..</code> 即可。</p><p>另外，MariaDB 不支持使用 <code>-DWITH_DEBUG=1</code>，应该使用 <code>-DCMAKE_BUILD_TYPE=Debug</code>；更多 MySQL 编译选项可以参考 <a href=http://dev.mysql.com/doc/mysql-sourcebuild-excerpt/en/source-configuration-options.html>Source Configration Options</a>，通过 <code>make</code> 编译时，可以通过 <code>-j</code> 选项多进程编译。</p><p>源码编译完成后，默认会将程序保存在 <code>sql/mysqld</code> 目录下，然后即可以通过 <code>make install</code> 将其安装在 <code>/opt/mysql-5.7</code> 目录下，为了方便运行，可以将 <code>/opt/mysql-5.7/bin</code> 添加到环境变量 <code>PATH</code> 中。</p><a class=anchor id=简单配置></a><h1>简单配置 <a href=#%e7%ae%80%e5%8d%95%e9%85%8d%e7%bd%ae aria-hidden=true>#</a></h1><p>MySQL 的配置文件保存在 <code>/etc/my.cnf</code>，包括了 <code>datadir</code>、<code>pid-file</code> 等的设置。另外，安装完老版本 root 密码为空，可以通过 <code>mysql_secure_installation</code> 来进行一些安全的配置，尤其是线上服务器，包括删除 <code>test</code> 数据库和默认创建的匿名用户。</p><p>为了方便登陆，可以设置 <code>~/.my.cnf</code>，仅为了本地方便登陆，线上生产环境一定不要配置。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[client]
</span></span><span class=line><span class=cl>user=root
</span></span><span class=line><span class=cl>password=YOUR_PASSWORD
</span></span><span class=line><span class=cl>socket=/tmp/mysql.sock
</span></span><span class=line><span class=cl>host=127.1
</span></span></code></pre></div><p>可以通过 <code>mysqld --verbose --help | head -15</code> 查看配置文件的默认加载顺序，当然，也可以直接通过 <code>mysql --help | grep my.cnf</code> 过滤进行查看；配置文件中通过 <code>#</code> 表示注释。</p><a class=anchor id=运行实例></a><h1>运行实例 <a href=#%e8%bf%90%e8%a1%8c%e5%ae%9e%e4%be%8b aria-hidden=true>#</a></h1><p>如下，简单以源码安装时的路径为例，如果是通过类似 YUM 安装的，则可以直接替换可执行文件的路径即可，不再赘述。</p><a class=anchor id=数据初始化></a><h2>数据初始化 <a href=#%e6%95%b0%e6%8d%ae%e5%88%9d%e5%a7%8b%e5%8c%96 aria-hidden=true>#</a></h2><p>第一次运行时需要做些初始化操作，主要是需要创建一些所必须的系统数据库以及相应的表，例如 <code>mysql</code>、<code>preformance_schema</code>、<code>information_schema</code> 等。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>----- 5.6以及之前的版本
</span></span><span class=line><span class=cl>$ /opt/mysql-5.6/script/mysql_install_db --no-defaults --basedir=/opt/mysql-5.6 \
</span></span><span class=line><span class=cl>    --datadir=/home/foobar/Workspace/mysql/data --user=mysql
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 5.7以及之后的版本，使用--initialize时密码保存在~/.mysql_secret
</span></span><span class=line><span class=cl>$ /opt/mysql-5.7/bin/mysqld --initialize-insecure --basedir=/opt/mysql-5.7 \
</span></span><span class=line><span class=cl>    --datadir=/home/foobar/Workspace/mysql/data --user=mysql
</span></span><span class=line><span class=cl>$ /opt/mysql-5.7/bin/mysql_install_db --no-defaults --basedir=/opt/mysql-5.7 \
</span></span><span class=line><span class=cl>    --datadir=/home/andy/Workspace/databases/mysql/data-mysql
</span></span></code></pre></div><p>如果不通过 <code>--user</code> 参数指定用户名，则使用默认的当前用户，此时不需要设置 <code>datadir</code> 目录的权限，否则需要设置相应权限。</p><p><code>basedir</code> 指定 MySQL 的安装目录；<code>datadir</code> 指定数据的存放位置；可以使用 <code>--defaults-file=my.cnf</code> 指定默认的配置文件，可以使用相对路径，默认相对于 <code>datadir</code>。在 <code>share</code> 子目录下，包含了一些配置文件，以及初次安装运行需要的初始数据库文件比如 <code>mysql_system_tables.sql</code> 。</p><p>注意，如果要使用参数指定默认配置文件，则 <code>--defaults-file</code> 选项应该放置在第一个参数，而且 <code>datadir</code>、<code>basedir</code> 必须使用绝对路径。</p><a class=anchor id=单实例运行></a><h2>单实例运行 <a href=#%e5%8d%95%e5%ae%9e%e4%be%8b%e8%bf%90%e8%a1%8c aria-hidden=true>#</a></h2><p>新建配置文件 <code>data/my.cnf</code> (可以为空)，并通过如下命令启动/停止/连接服务器。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>----- 1. 切换到工作目录
</span></span><span class=line><span class=cl>$ cd /home/foobar/Workspace/mysql
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 2. 启动单个MySQL实例，前台运行，如果要后台运行直接添加&amp;即可
</span></span><span class=line><span class=cl>$ /opt/mysql-5.7/bin/mysqld --defaults-file=data/my.cnf  \
</span></span><span class=line><span class=cl>    --datadir=/home/foobar/Workspace/mysql/data          \
</span></span><span class=line><span class=cl>    --basedir=/opt/mysql-5.7 --skip-networking --debug
</span></span><span class=line><span class=cl>$ /opt/mysql-5.7/bin/mysqld_safe --defaults-file=data/my.cnf  \
</span></span><span class=line><span class=cl>    --datadir=/home/foobar/Workspace/mysql/data          \
</span></span><span class=line><span class=cl>    --basedir=/opt/mysql-5.7 --skip-networking --debug &amp;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 3. 如下命令连接到数据库，5.6之前为密码为空，5.7密码保存在~/.mysql_secret
</span></span><span class=line><span class=cl>$ /opt/mysql-5.7/bin/mysql -uroot -p&#39;init-password&#39; -S /tmp/mysql.sock
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 4. 可以通过如下命令关闭、查看状态
</span></span><span class=line><span class=cl>$ /opt/mysql-5.7/bin/mysqladmin -uroot -p&#39;init-password&#39; shutdown
</span></span><span class=line><span class=cl>$ /opt/mysql-5.7/bin/mysqladmin -uroot -p&#39;init-password&#39; status
</span></span></code></pre></div><p>在通过上述命令启动服务器时，添加了 <code>skip-networking</code> 参数，也就是不启动 <code>TCP</code> 监听端口，只能通过 <code>sock</code> 连接。</p><p>需要注意的是，如果不使用 <code>--defaults-file</code> 选项，<code>mysqld</code> 会自动读取 <code>/etc/my.cnf</code> 配置文件，如果默认值与期望值不符，从而可能会导致部分错误，当然可以删除该配置文件，不过不建议。</p><p><strong>推荐</strong> 可以将对应的启动、关闭命令设置为 alias ，这样可以简化启动方式，同时仍然可以动态添加参数，如直接再在命令的末尾添加 <code>--debug</code> 。</p><a class=anchor id=多实例运行></a><h2>多实例运行 <a href=#%e5%a4%9a%e5%ae%9e%e4%be%8b%e8%bf%90%e8%a1%8c aria-hidden=true>#</a></h2><p>多实例主要是端口以及保存的数据目录不同，通过简单设置这些参数，可以在同一台 server 上启动多个实例，下面启动一个端口号为 <code>3307</code> 的实例，其中配置文件 <code>mysql3307.cnf</code> 的内容如下。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat mysql3307.cnf
</span></span><span class=line><span class=cl>[mysqld]
</span></span><span class=line><span class=cl>port = 3307
</span></span><span class=line><span class=cl>server-id = 3307
</span></span><span class=line><span class=cl>basedir = /opt/mysql-5.7
</span></span><span class=line><span class=cl>socket = /tmp/mysql3307.sock
</span></span><span class=line><span class=cl>pid-file = /home/foobar/Workspace/mysql/data3307/mysql3307.pid
</span></span><span class=line><span class=cl>datadir = /home/foobar/Workspace/mysql/data3307
</span></span></code></pre></div><p>然后，可以通过如下命令设置并启动一个新的 MySQL 实例。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>----- 1. 创建目录
</span></span><span class=line><span class=cl>$ cd /home/foobar/Workspace/mysql &amp;&amp; mkdir data3307
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 2. 如上，初始化实例
</span></span><span class=line><span class=cl>$ /opt/mysql-5.7/bin/mysqld --initialize-insecure --basedir=/opt/mysql-5.7 \
</span></span><span class=line><span class=cl>    --datadir=/home/foobar/Workspace/mysql/data3307 --user=mysql
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 3. 启动实例
</span></span><span class=line><span class=cl>$ /opt/mariadb/bin/mysqld --defaults-file=data3307/mysql3307.cnf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 4. 连接数据库
</span></span><span class=line><span class=cl>$ mysql -uroot -h127.1 -P3307
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>----- 5. 关闭数据库
</span></span><span class=line><span class=cl>$ /opt/mariadb/bin/mysqladmin -uroot -S /tmp/mysql3307.sock shutdown
</span></span></code></pre></div><p>对于多实例，可以通过上述的方法创建实例，不过管理操作还是略微有点复杂，实际上可以直接通过 <code>mysqld_multi</code> 命令管理，通过 <code>mysqld_multi --example</code> 查看示例配置文件，或者使用 <code>multi.cnf</code> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat multi.cnf
</span></span><span class=line><span class=cl>[mysqld_multi]
</span></span><span class=line><span class=cl>mysqld = /opt/mysql-5.7/bin/mysqld
</span></span><span class=line><span class=cl>mysqladmin = /opt/mysql-5.7/bin/mysqladmin
</span></span><span class=line><span class=cl>user = root
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[mysqld3307]
</span></span><span class=line><span class=cl>socket = /tmp/mysql3307.sock
</span></span><span class=line><span class=cl>port = 3307
</span></span><span class=line><span class=cl>pid-file = /home/foobar/Workspace/mysql/data3307/mysql3307.pid
</span></span><span class=line><span class=cl>datadir = /home/foobar/Workspace/mysql/data3307
</span></span><span class=line><span class=cl>basedir = /opt/mysql-5.7
</span></span><span class=line><span class=cl>server-id=3307
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[mysqld3308]
</span></span><span class=line><span class=cl>socket = /tmp/mysql3308.sock
</span></span><span class=line><span class=cl>port = 3308
</span></span><span class=line><span class=cl>pid-file = /home/foobar/Workspace/mysql/data3308/mysql3308.pid
</span></span><span class=line><span class=cl>datadir = /home/foobar/Workspace/mysql/data3308
</span></span><span class=line><span class=cl>basedir = /opt/mysql-5.7
</span></span><span class=line><span class=cl>server-id=3308
</span></span></code></pre></div><p>如下是一些常见的操作。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cd /home/foobar/Workspace/mysql
</span></span><span class=line><span class=cl>$ /opt/mysql-5.7/bin/mysqld_multi --defaults-file=multi.cnf report     ← 查看多个实例状态
</span></span><span class=line><span class=cl>$ /opt/mysql-5.7/bin/mysqld_multi --defaults-file=multi.cnf start
</span></span><span class=line><span class=cl>$ /opt/mysql-5.7/bin/mysqld_multi --defaults-file=multi.cnf stop
</span></span></code></pre></div><a class=anchor id=调试程序></a><h1>调试程序 <a href=#%e8%b0%83%e8%af%95%e7%a8%8b%e5%ba%8f aria-hidden=true>#</a></h1><p>如果要调试需要在编译时添加 <code>-DCMAKE_BUILD_TYPE=Debug</code> 选项，可以通过 <code>gdb</code> 或者使用 <code>dbug</code> 打印调试信息。</p><a class=anchor id=使用-gdb></a><h2>使用 GDB <a href=#%e4%bd%bf%e7%94%a8-gdb aria-hidden=true>#</a></h2><p>可以通过如下的方式加载程序，然后运行。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gdb -args /opt/mariadb/bin/mysqld --defaults-file=......
</span></span><span class=line><span class=cl>(gdb) run
</span></span></code></pre></div><p>如果 MySQL 已经启动，此时可以通过 <code>gdb</code> 的 <code>attach PID</code> 命令来调试，一般会阻塞在系统调用 <code>poll()</code> 处；调试结束通过 <code>detach</code> 命令退出。注意，要先 <strong>设置断点</strong> 。</p><p>如果通过 CMake 进行编译，往往会采用绝对路径，可以通过 <code>readelf -p .debug_str</code> 查看，此时设置/查看断点时应该使用绝对路径。可以修改/添加如下文件。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat CMakeLists.txt                         <span class=c1># 添加如下内容</span>
</span></span><span class=line><span class=cl>... ...
</span></span><span class=line><span class=cl>CONFIGURE_FILE<span class=o>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;</span><span class=si>${</span><span class=nv>PROJECT_SOURCE_DIR</span><span class=si>}</span><span class=s2>/gcc_debug_fix.sh.in&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;</span><span class=si>${</span><span class=nv>PROJECT_BINARY_DIR</span><span class=si>}</span><span class=s2>/gcc_debug_fix.sh&#34;</span>
</span></span><span class=line><span class=cl>    @ONLY<span class=o>)</span>
</span></span><span class=line><span class=cl>... ...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat cmake/mysql_add_executable.cmake       <span class=c1># 添加如下内容</span>
</span></span><span class=line><span class=cl>ADD_EXECUTABLE<span class=o>(</span>... ...<span class=o>)</span>
</span></span><span class=line><span class=cl>SET_TARGET_PROPERTIES<span class=o>(</span><span class=si>${</span><span class=nv>target</span><span class=si>}</span> PROPERTIES
</span></span><span class=line><span class=cl>    RULE_LAUNCH_COMPILE <span class=s2>&#34;</span><span class=si>${</span><span class=nv>PROJECT_BINARY_DIR</span><span class=si>}</span><span class=s2>/gcc_debug_fix.sh&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>... ...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat gcc_debug_fix.sh.in                    <span class=c1># 添加如下文件，需要设置可执行</span>
</span></span><span class=line><span class=cl><span class=c1>#!/bin/sh</span>
</span></span><span class=line><span class=cl><span class=nv>PROJECT_BINARY_DIR</span><span class=o>=</span><span class=s2>&#34;@PROJECT_BINARY_DIR@&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>PROJECT_SOURCE_DIR</span><span class=o>=</span><span class=s2>&#34;@PROJECT_SOURCE_DIR@&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># shell script invoked with the following arguments</span>
</span></span><span class=line><span class=cl><span class=c1># $(CXX) $(CXX_DEFINES) $(CXX_FLAGS) -o OBJECT_FILE -c SOURCE_FILE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># extract parameters</span>
</span></span><span class=line><span class=cl><span class=nv>SOURCE_FILE</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=p>@: -1:</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>OBJECT_FILE</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=p>@: -3:</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>COMPILER_AND_FLAGS</span><span class=o>=</span><span class=si>${</span><span class=p>@:</span><span class=nv>1</span><span class=p>:</span><span class=nv>$#</span><span class=p>-4</span><span class=si>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># make source file path relative to project source dir</span>
</span></span><span class=line><span class=cl><span class=nv>SOURCE_FILE_RELATIVE</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>SOURCE_FILE</span><span class=p>:</span><span class=si>${#</span><span class=nv>PROJECT_SOURCE_DIR</span><span class=si>}</span><span class=p> + 1</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># make object file path absolute</span>
</span></span><span class=line><span class=cl><span class=nv>OBJECT_FILE_ABSOLUTE</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$PROJECT_BINARY_DIR</span><span class=s2>/</span><span class=nv>$OBJECT_FILE</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=s2>&#34;</span><span class=nv>$PROJECT_SOURCE_DIR</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># invoke compiler</span>
</span></span><span class=line><span class=cl><span class=nb>exec</span> <span class=nv>$COMPILER_AND_FLAGS</span> -c <span class=s2>&#34;</span><span class=si>${</span><span class=nv>SOURCE_FILE_RELATIVE</span><span class=si>}</span><span class=s2>&#34;</span> -o <span class=s2>&#34;</span><span class=si>${</span><span class=nv>OBJECT_FILE_ABSOLUTE</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></div><p>编译方式仍如上所示，相关内容可以参考 <a href=http://www.stackoverflow.com/questions/9607155/make-gcc-put-relative-filenames-in-debug-information>Make gcc put relative filenames in debug information</a> 。</p><a class=anchor id=调试技巧></a><h2>调试技巧 <a href=#%e8%b0%83%e8%af%95%e6%8a%80%e5%b7%a7 aria-hidden=true>#</a></h2><p>为了比较好的查看变量内容，可以设置如下。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(gdb) set print vtbl on         ← 用比较规整的格式来显示虚函数表
</span></span><span class=line><span class=cl>(gdb) ptype obj/class/struct    ← 查看obj/class/struct的成员，但是会把基类指针指向的派生类识别为基类
</span></span><span class=line><span class=cl>(gdb) set print object on       ← 查看派生对象的真实类名
</span></span><span class=line><span class=cl>(gdb) set print pretty on       ← 以树形打印对象的成员，可以清晰展示继承关系
</span></span></code></pre></div><p>链接到 <code>mysqld</code> 后，会阻塞在 <code>poll()</code>，然后设置调试入口，在此简单列举一下常见的调试入口点。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>handle_connections_sockets() @ mysqld.cc
</span></span><span class=line><span class=cl>    等待接收处理新的链接。
</span></span><span class=line><span class=cl>do_handle_one_connection() @ sql_connect.cc
</span></span><span class=line><span class=cl>    接下来的处理过程为处理链接，注意该处理函数与链接的处理方式有关。
</span></span><span class=line><span class=cl>do_command() @ sql_parse.cc; dispatch_command() @ sql_parse.cc
</span></span><span class=line><span class=cl>    接着是处理接收到的 SQL，其中有一个变量 THD thd @ sql_class.h 会经常使用，该结构体中包含了当前线程的相关信息。
</span></span></code></pre></div><p>如下是简单的在 <code>dispatch_command()</code> 断点处打印的信息，用 <code>@</code> 简单标示断点信息。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># @ dispatch_command()
</span></span><span class=line><span class=cl>(gdb) p thd.net                 ← 查看网络的信息
</span></span><span class=line><span class=cl>(gdb) p packet                  ← 请求的命令
</span></span></code></pre></div><a class=anchor id=使用-dbug></a><h2>使用 DBUG <a href=#%e4%bd%bf%e7%94%a8-dbug aria-hidden=true>#</a></h2><p>对于 MySQL 需要在编译时添加调试选项 <code>-DCMAKE_BUILD_TYPE=Debug</code>，然后在启动时使用 <code>--debug</code> 参数，默认会启动所有的调试选项，调试的信息会保存在 <code>/tmp/mysqld.trace</code> 文件中。</p><p>可以在启动时使用 <code>--debug[=debug_options]</code> 添加调试选项，默认值是 <code>d:t:i:o,/tmp/mysqld.trace</code>，选项的格式为 <code>[field1]:[field2]...</code> 每个 <code>field</code> 之间用冒号分割，各个 <code>field</code> 的内容为 <code>flag[,modifier,modifier...]</code> 。</p><p>常用的标记有：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>d
</span></span><span class=line><span class=cl>    允许对当前状态从DBUG_&lt;N&gt;宏输出。可能跟着一列关键词，这些关键词仅对那些带有关键词的DBUG宏选择输出。
</span></span><span class=line><span class=cl>    一个空的关键词列意味着对所有宏输出。
</span></span><span class=line><span class=cl>t
</span></span><span class=line><span class=cl>    允许函数调用/退出跟踪行。可能跟着一个给出最大跟踪级别的数字列（只含一个修改量），超过这个数字，
</span></span><span class=line><span class=cl>    调试中或跟踪中的宏不能产生任何输出。 默认为一个编译时间选项。
</span></span><span class=line><span class=cl>i
</span></span><span class=line><span class=cl>    对调试或跟踪输出的每一行用PID或线程ID识别进程。
</span></span><span class=line><span class=cl>o
</span></span><span class=line><span class=cl>    重定向调试器输出流到指定文件，默认输出是stderr 文件。
</span></span></code></pre></div><p>注意：调试输出选项是在 <code>mysqld_main()</code> 中的 <code>handle_options()</code> 返回后开始输出的，之前应该是还没有初始化，另外，在运行的时候也可以通过，如下的方式修改，日志的保存位置可以查看该变量。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>mysql&gt; SHOW VARIABLES LIKE &#39;debug&#39;;
</span></span><span class=line><span class=cl>mysql&gt; SET GLOBAL debug = &#39;d:t:i:o,/tmp/mysqld.trace&#39;;
</span></span><span class=line><span class=cl>mysql&gt; SET SESSION debug = &#39;d:t:i:o,/tmp/mysqld.trace&#39;;
</span></span></code></pre></div><p>其中，<code>DBUG_RETURN()</code> 后面的数字对应的是行号。</p><p>与 <code>dbug</code> 相关内容还可以参考 <a href=http://sourceforge.net/projects/dbug/>dbug 源码</a>，其中有 <code>example.c</code> 文件，可以将其复制到 <code>src</code> 目录下，最简单的方式是直接通过 <code>gcc example.c dbug.c</code> 编译，编译后运行将直接输出到终端上；当要取消调试选项时只需要添加宏 <code>#define DBUG_OFF</code>。</p><p>注意：MySQL 的 <code>dbug</code> 库是经过修改的，会有稍微的差别。</p><a class=anchor id=打印执行的sql></a><h1>打印执行的SQL <a href=#%e6%89%93%e5%8d%b0%e6%89%a7%e8%a1%8c%e7%9a%84sql aria-hidden=true>#</a></h1><p>通常在测试某些功能时，希望可以直接输出所执行的 SQL，通常可以使用如下的两种方式。</p><a class=anchor id=general-log></a><h2>general log <a href=#general-log aria-hidden=true>#</a></h2><p>可以通过 <code>general_log</code> 打开日志，记录所有的执行日志，当然只用于测试，生产环境不要打开。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>mysql&gt; show global variables like &#39;general%&#39;;
</span></span><span class=line><span class=cl>mysql&gt; set global general_log=1;                  # 打开查询日志
</span></span></code></pre></div><p>默认日志保存在 <code>$datadir/$general_log_file</code> 文件中，另外，<code>slow query log</code> 用于记录执行时间超过 <code>long_query_time</code> 的 SQL 。</p><a class=anchor id=tcpdump></a><h2>tcpdump <a href=#tcpdump aria-hidden=true>#</a></h2><p>可以通过 <code>tcpdump</code> 截取 MySQL 报文，假设使用的时 <code>lo</code> 接口；需要注意的是：使用本地连接可能会直接用 Sock 链接，通过客户端创建连接时需要指定 <code>-h 127.1</code> 。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># tcpdump -i lo -s 0 -l -w - dst port 3306 | strings
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>其中的选项为：
</span></span><span class=line><span class=cl>-s 0     将截取报文的长度设置为默认值 65536 bytes
</span></span><span class=line><span class=cl>-i lo    指定监听的网络接口
</span></span><span class=line><span class=cl>-l       输出变为缓冲行形式
</span></span><span class=line><span class=cl>-w       直接将包写入文件中，并不分析和打印出来，在此输出到标准输入
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># tcpdump -i lo -s 0 -l -w - dst port 3306 | strings | perl -e &#39;
</span></span><span class=line><span class=cl>while(&lt;&gt;) { chomp; next if /^[^ ]+[ ]*$/;
</span></span><span class=line><span class=cl>  if(/^(SELECT|UPDATE|DELETE|INSERT|SET|COMMIT|ROLLBACK|CREATE|DROP|ALTER)/i) {
</span></span><span class=line><span class=cl>    if (defined $q) { print &#34;$q\n&#34;; }
</span></span><span class=line><span class=cl>    $q=$_;
</span></span><span class=line><span class=cl>  } else {
</span></span><span class=line><span class=cl>    $_ =~ s/^[ \t]+//; $q.=&#34; $_&#34;;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}&#39;
</span></span></code></pre></div><a class=anchor id=参考></a><h1>参考 <a href=#%e5%8f%82%e8%80%83 aria-hidden=true>#</a></h1><p>其中调试时的相对路径设置可以参考 <a href=http://stackoverflow.com/questions/9607155/make-gcc-put-relative-filenames-in-debug-information>stackflow</a> 或者 [本地文档](/reference/databases/mysql/make gcc put relative filenames in debug information.mht) 。
&ndash;></p></div></div><div class="sidebar col-xl-3 mt-2"><div id=toc class=position-fixed><nav id=TableOfContents><ul><li><a href=#安装>安装</a><ul><li><a href=#密码配置>密码配置</a></li><li><a href=#编译安装>编译安装</a></li></ul></li><li><a href=#简单配置>简单配置</a></li><li><a href=#运行实例>运行实例</a><ul><li><a href=#数据初始化>数据初始化</a></li><li><a href=#单实例运行>单实例运行</a></li><li><a href=#多实例运行>多实例运行</a></li></ul></li><li><a href=#调试程序>调试程序</a><ul><li><a href=#使用-gdb>使用 GDB</a></li><li><a href=#调试技巧>调试技巧</a></li><li><a href=#使用-dbug>使用 DBUG</a></li></ul></li><li><a href=#打印执行的sql>打印执行的SQL</a><ul><li><a href=#general-log>general log</a></li><li><a href=#tcpdump>tcpdump</a></li></ul></li><li><a href=#参考>参考</a></li></ul></nav></div></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class=text-center>Built by GoHalo, generated with <a class=text-muted href=https://gohugo.io>Hugo</a>, and hosted on GitHub Pages</div></div><div class=row><div class=text-center>Copyright © 2013-2025 GoHalo. All Rights Reserved.</div></div></div></footer><script src=https://gohalo.github.io/bootstrap/js/bootstrap.bundle.min.js></script>
<script src=/main.b9cbcb174709877512d64e24f297f66a40c8d91c9a81128cb04bdd7b10247df8.js integrity="sha256-ucvLF0cJh3US1k4k8pf2akDI2RyagRKMsEvdexAkffg=" crossorigin=anonymous></script>
<a href=# class="btn btn-light btn-lg backtop" title=返回顶部><i class="fa fa-angle-double-up" aria-hidden=true></i></a></body></html>